<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ConnectedShop API Documentation</title>
<style>
  :root {
    --bg: #0f1117; --bg2: #1a1d27; --bg3: #22263a; --border: #2e3352;
    --accent: #4f7ef8; --accent2: #6c63ff; --green: #22c55e; --red: #ef4444;
    --yellow: #f59e0b; --text: #e2e8f0; --text2: #94a3b8; --code-bg: #141720;
    --sidebar-w: 280px;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { font-family: 'Segoe UI', system-ui, sans-serif; background: var(--bg); color: var(--text); line-height: 1.6; }
  #layout { display: flex; min-height: 100vh; }
  #sidebar { width: var(--sidebar-w); min-width: var(--sidebar-w); background: var(--bg2); border-right: 1px solid var(--border); position: fixed; top: 0; left: 0; height: 100vh; overflow-y: auto; display: flex; flex-direction: column; z-index: 100; }
  #main { margin-left: var(--sidebar-w); flex: 1; padding: 2rem 3rem; max-width: 1100px; }
  .sidebar-header { padding: 1.25rem 1rem; border-bottom: 1px solid var(--border); background: linear-gradient(135deg, #1e2340, #16192b); position: sticky; top: 0; z-index: 10; }
  .sidebar-header h2 { font-size: 0.85rem; font-weight: 700; color: var(--accent); letter-spacing: 0.08em; text-transform: uppercase; }
  .sidebar-header p { font-size: 0.75rem; color: var(--text2); margin-top: 0.2rem; }
  #search-box { width: 100%; margin: 0.75rem 0 0; padding: 0.45rem 0.7rem; background: var(--bg3); border: 1px solid var(--border); border-radius: 6px; color: var(--text); font-size: 0.8rem; outline: none; }
  #search-box:focus { border-color: var(--accent); }
  .nav-section { padding: 0.5rem 0; }
  .nav-section-title { font-size: 0.65rem; font-weight: 700; color: var(--text2); text-transform: uppercase; letter-spacing: 0.1em; padding: 0.4rem 1rem 0.2rem; }
  .nav-link { display: block; padding: 0.3rem 1rem 0.3rem 1.25rem; font-size: 0.8rem; color: var(--text2); text-decoration: none; border-left: 2px solid transparent; transition: all 0.15s; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  .nav-link:hover { color: var(--text); background: var(--bg3); border-left-color: var(--accent); }
  .nav-link.active { color: var(--accent); border-left-color: var(--accent); background: rgba(79,126,248,0.08); }
  #topbar { background: var(--bg2); border-bottom: 1px solid var(--border); padding: 1rem 3rem; display: flex; align-items: center; gap: 1.5rem; position: sticky; top: 0; z-index: 50; margin-left: var(--sidebar-w); }
  #topbar h1 { font-size: 1.2rem; font-weight: 700; background: linear-gradient(135deg, var(--accent), var(--accent2)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
  .badge { font-size: 0.7rem; font-weight: 600; padding: 0.15rem 0.55rem; border-radius: 999px; background: rgba(79,126,248,0.2); color: var(--accent); border: 1px solid rgba(79,126,248,0.3); }
  section { margin-bottom: 4rem; scroll-margin-top: 80px; }
  h2.section-title { font-size: 1.6rem; font-weight: 800; margin-bottom: 0.5rem; padding-bottom: 0.75rem; border-bottom: 2px solid var(--border); display: flex; align-items: center; gap: 0.75rem; }
  h3.sub-title { font-size: 1rem; font-weight: 700; margin: 1.75rem 0 0.6rem; color: var(--text); }
  p { color: var(--text2); margin-bottom: 0.75rem; font-size: 0.93rem; }
  .method-grid { display: flex; flex-direction: column; gap: 0.75rem; margin-top: 0.5rem; }
  .method-card { background: var(--bg2); border: 1px solid var(--border); border-radius: 10px; overflow: hidden; transition: border-color 0.2s; }
  .method-card:hover { border-color: var(--accent); }
  .method-header { display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; cursor: pointer; user-select: none; }
  .method-name { font-family: 'Cascadia Code', 'Fira Code', monospace; font-size: 0.88rem; font-weight: 600; color: var(--accent); }
  .method-desc { font-size: 0.82rem; color: var(--text2); margin-left: auto; }
  .expand-icon { color: var(--text2); font-size: 0.75rem; transition: transform 0.2s; }
  .method-card.open .expand-icon { transform: rotate(180deg); }
  .method-body { display: none; padding: 0 1rem 1rem; border-top: 1px solid var(--border); }
  .method-card.open .method-body { display: block; }
  .ret-badge { font-size: 0.7rem; font-weight: 600; padding: 0.1rem 0.45rem; border-radius: 4px; font-family: monospace; }
  .ret-bool { background: rgba(34,197,94,0.15); color: var(--green); }
  .ret-string { background: rgba(79,126,248,0.15); color: var(--accent); }
  .ret-void { background: rgba(148,163,184,0.1); color: var(--text2); }
  .ret-int { background: rgba(245,158,11,0.15); color: var(--yellow); }
  .ret-double { background: rgba(245,158,11,0.15); color: var(--yellow); }
  .ret-intptr { background: rgba(108,99,255,0.15); color: var(--accent2); }
  .param-table { width: 100%; border-collapse: collapse; margin: 0.6rem 0; font-size: 0.82rem; }
  .param-table th { text-align: left; padding: 0.4rem 0.6rem; background: var(--bg3); color: var(--text2); font-size: 0.72rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.06em; border-bottom: 1px solid var(--border); }
  .param-table td { padding: 0.4rem 0.6rem; border-bottom: 1px solid rgba(46,51,82,0.5); vertical-align: top; }
  .param-table tr:last-child td { border-bottom: none; }
  .param-name { font-family: monospace; color: var(--accent); }
  .param-type { font-family: monospace; color: var(--yellow); font-size: 0.78rem; }
  .param-desc { color: var(--text2); }
  .out-badge { font-size: 0.65rem; background: rgba(108,99,255,0.2); color: var(--accent2); border-radius: 3px; padding: 0.05rem 0.3rem; margin-left: 0.3rem; }
  .code-block { background: var(--code-bg); border: 1px solid var(--border); border-radius: 8px; padding: 1rem; font-family: 'Cascadia Code', 'Fira Code', 'Courier New', monospace; font-size: 0.8rem; overflow-x: auto; white-space: pre; color: #abb2bf; margin: 0.75rem 0; position: relative; }
  .code-label { font-size: 0.65rem; font-weight: 700; color: var(--text2); text-transform: uppercase; letter-spacing: 0.08em; margin: 0.75rem 0 0.3rem; }
  .kw { color: #c678dd; } .str { color: #98c379; } .cm { color: #5c6370; font-style: italic; }
  .fn { color: #61afef; } .num { color: #d19a66; } .tp { color: #e5c07b; } .op { color: #56b6c2; }
  .info-box { border-radius: 8px; padding: 0.75rem 1rem; font-size: 0.83rem; margin: 0.75rem 0; border-left: 3px solid; }
  .info-box.tip { background: rgba(34,197,94,0.08); border-color: var(--green); color: #86efac; }
  .info-box.warn { background: rgba(245,158,11,0.08); border-color: var(--yellow); color: #fcd34d; }
  .info-box.note { background: rgba(79,126,248,0.08); border-color: var(--accent); color: #93c5fd; }
  .info-box .label { font-weight: 700; text-transform: uppercase; font-size: 0.7rem; letter-spacing: 0.08em; margin-bottom: 0.25rem; }
  .overview-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem; margin: 1.25rem 0; }
  .overview-card { background: var(--bg2); border: 1px solid var(--border); border-radius: 10px; padding: 1rem; text-align: center; transition: border-color 0.2s, transform 0.15s; cursor: pointer; text-decoration: none; display: block; }
  .overview-card:hover { border-color: var(--accent); transform: translateY(-2px); }
  .overview-card .icon { font-size: 1.6rem; margin-bottom: 0.4rem; }
  .overview-card .label { font-size: 0.82rem; font-weight: 600; color: var(--text); }
  .overview-card .count { font-size: 0.72rem; color: var(--text2); margin-top: 0.15rem; }
  .error-table { width: 100%; border-collapse: collapse; font-size: 0.83rem; }
  .error-table th { background: var(--bg3); padding: 0.5rem 0.75rem; text-align: left; font-size: 0.72rem; font-weight: 700; text-transform: uppercase; color: var(--text2); border-bottom: 1px solid var(--border); }
  .error-table td { padding: 0.5rem 0.75rem; border-bottom: 1px solid rgba(46,51,82,0.4); }
  .error-table tr:last-child td { border-bottom: none; }
  .code-val { font-family: monospace; font-weight: 700; color: var(--accent); }
  .pass-val { color: var(--green); font-weight: 600; } .fail-val { color: var(--red); font-weight: 600; }
  ::-webkit-scrollbar { width: 6px; height: 6px; }
  ::-webkit-scrollbar-track { background: var(--bg); }
  ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
  ::-webkit-scrollbar-thumb:hover { background: var(--accent); }
  [id] { scroll-margin-top: 70px; }
</style>
</head>
<body>

<nav id="sidebar">
  <div class="sidebar-header">
    <h2>ConnectedShop API</h2>
    <p>DLL Export Reference</p>
    <input id="search-box" type="text" placeholder="Search methods‚Ä¶" oninput="filterNav(this.value)">
  </div>
  <div class="nav-section">
    <div class="nav-section-title">Getting Started</div>
    <a class="nav-link" href="#overview">Overview</a>
    <a class="nav-link" href="#initialization">Initialization</a>
    <a class="nav-link" href="#authorization">Authorization</a>
    <a class="nav-link" href="#error-handling">Error Handling</a>
  </div>
  <div class="nav-section">
    <div class="nav-section-title">Core</div>
    <a class="nav-link" href="#connectedshop">ConnectedShop Core</a>
    <a class="nav-link" href="#allocate">Allocate</a>
    <a class="nav-link" href="#approval">Approval</a>
    <a class="nav-link" href="#assemblies">Assemblies</a>
  </div>
  <div class="nav-section">
    <div class="nav-section-title">Documents</div>
    <a class="nav-link" href="#delivery-notes">Delivery Notes</a>
    <a class="nav-link" href="#invoice">Invoice</a>
    <a class="nav-link" href="#export">Export</a>
    <a class="nav-link" href="#reports">Reports</a>
  </div>
  <div class="nav-section">
    <div class="nav-section-title">Jobs &amp; Orders</div>
    <a class="nav-link" href="#jobs">Jobs</a>
    <a class="nav-link" href="#job-item">Job Items</a>
    <a class="nav-link" href="#po">Purchase Orders</a>
    <a class="nav-link" href="#po-item">PO Items</a>
    <a class="nav-link" href="#wo">Work Orders</a>
    <a class="nav-link" href="#ncr">NCR</a>
  </div>
  <div class="nav-section">
    <div class="nav-section-title">Inventory &amp; Stock</div>
    <a class="nav-link" href="#batch">Batch</a>
    <a class="nav-link" href="#stocks">Stocks</a>
    <a class="nav-link" href="#warehouse">Warehouse</a>
    <a class="nav-link" href="#plt">Production Location Tracking</a>
  </div>
  <div class="nav-section">
    <div class="nav-section-title">Contacts &amp; Costing</div>
    <a class="nav-link" href="#contact">Contact</a>
    <a class="nav-link" href="#costing">Costing</a>
    <a class="nav-link" href="#user-permission">User Permissions</a>
  </div>
  <div class="nav-section">
    <div class="nav-section-title">Production</div>
    <a class="nav-link" href="#planner">Planner</a>
    <a class="nav-link" href="#program-recording">Program Recording</a>
    <a class="nav-link" href="#sigmanest">SigmaNEST</a>
    <a class="nav-link" href="#operations">Operations</a>
    <a class="nav-link" href="#big-data">Big Data</a>
  </div>
  <div class="nav-section">
    <div class="nav-section-title">System</div>
    <a class="nav-link" href="#plugins">Plugins</a>
    <a class="nav-link" href="#ui">UI</a>
  </div>
</nav>

<div id="topbar">
  <h1>ConnectedShop API</h1>
  <span class="badge">DLL Export</span>
  <span class="badge">C# / .NET</span>
  <span class="badge">28 Modules ¬∑ 200+ Methods</span>
</div>

<main id="main">

<!-- ‚îÄ‚îÄ OVERVIEW ‚îÄ‚îÄ -->
<section id="overview">
  <h2 class="section-title"><span class="section-icon">üìò</span>Overview</h2>
  <p>The <strong>ConnectedShop API</strong> is a Windows DLL export library written in C# (.NET Framework). It provides programmatic access to the full ConnectedShop / SigmaMRP manufacturing platform.</p>
  <div class="info-box note"><div class="label">Architecture</div>All exported methods are <strong>static</strong> on the <code>ConnectedShop</code> class. Internally they delegate to <code>MRPDataIntegrity.dll</code> via reflection. Every call passes an authorization check before executing.</div>
  <div class="overview-grid">
    <a class="overview-card" href="#connectedshop"><div class="icon">‚öôÔ∏è</div><div class="label">Core</div><div class="count">Init ¬∑ Shutdown ¬∑ Token</div></a>
    <a class="overview-card" href="#jobs"><div class="icon">üìã</div><div class="label">Jobs</div><div class="count">25 methods</div></a>
    <a class="overview-card" href="#po"><div class="icon">üõí</div><div class="label">Purchase Orders</div><div class="count">8 methods</div></a>
    <a class="overview-card" href="#batch"><div class="icon">üì¶</div><div class="label">Batch</div><div class="count">9 methods</div></a>
    <a class="overview-card" href="#contact"><div class="icon">üë§</div><div class="label">Contact</div><div class="count">2 methods</div></a>
    <a class="overview-card" href="#costing"><div class="icon">üí∞</div><div class="label">Costing</div><div class="count">11 methods</div></a>
    <a class="overview-card" href="#assemblies"><div class="icon">üîß</div><div class="label">Assemblies</div><div class="count">8 methods</div></a>
    <a class="overview-card" href="#sigmanest"><div class="icon">‚úÇÔ∏è</div><div class="label">SigmaNEST</div><div class="count">6 methods</div></a>
    <a class="overview-card" href="#planner"><div class="icon">üìÖ</div><div class="label">Planner</div><div class="count">6 methods</div></a>
    <a class="overview-card" href="#plt"><div class="icon">üìç</div><div class="label">PLT</div><div class="count">6 methods</div></a>
    <a class="overview-card" href="#reports"><div class="icon">üìä</div><div class="label">Reports</div><div class="count">8 test scenarios</div></a>
    <a class="overview-card" href="#plugins"><div class="icon">üîå</div><div class="label">Plugins</div><div class="count">40+ hooks</div></a>
  </div>
</section>

<!-- ‚îÄ‚îÄ INITIALIZATION ‚îÄ‚îÄ -->
<section id="initialization">
  <h2 class="section-title"><span class="section-icon">üöÄ</span>Initialization</h2>
  <p>Before calling any API method you must initialize the library. Call <code>Shutdown()</code> when done.</p>
  <div class="code-block"><span class="cm">// 1. Initialize</span>
<span class="tp">bool</span> ok = <span class="fn">ConnectedShop.Init</span>(
    <span class="str">"Data Source=localhost;Initial Catalog=MXPDatabase;Integrated Security=True;"</span>,
    <span class="str">""</span>,       <span class="cm">// currentUserPk ‚Äî empty = default</span>
    <span class="str">"en-us"</span>   <span class="cm">// locale</span>
);

<span class="cm">// 2. Optionally set auth token</span>
<span class="fn">ConnectedShop.SetToken</span>(<span class="str">"your-api-token"</span>);

<span class="cm">// 3. Use the API ...</span>

<span class="cm">// 4. Shutdown</span>
<span class="fn">ConnectedShop.Shutdown</span>();</div>
</section>

<!-- ‚îÄ‚îÄ AUTHORIZATION ‚îÄ‚îÄ -->
<section id="authorization">
  <h2 class="section-title"><span class="section-icon">üîí</span>Authorization</h2>
  <p>Every API call runs through <code>CallHelper.IsAPIAuthorized(methodName)</code>. Only <code>SetToken()</code> bypasses this check.</p>
  <div class="info-box warn"><div class="label">Important</div>Unauthorized calls return a failure value (empty string, <code>false</code>, or error text) without executing business logic.</div>
</section>

<!-- ‚îÄ‚îÄ ERROR HANDLING ‚îÄ‚îÄ -->
<section id="error-handling">
  <h2 class="section-title"><span class="section-icon">‚ö†Ô∏è</span>Error Handling</h2>
  <table class="error-table">
    <tr><th>Return Type</th><th>Success</th><th>Failure</th></tr>
    <tr><td><span class="param-type">string</span></td><td class="pass-val">GUID or message containing "successfully"</td><td class="fail-val">Error description or empty string</td></tr>
    <tr><td><span class="param-type">bool</span></td><td class="pass-val">true</td><td class="fail-val">false</td></tr>
    <tr><td><span class="param-type">int</span></td><td class="pass-val">Result ‚â• 0</td><td class="fail-val">Negative or documented code</td></tr>
    <tr><td><span class="param-type">void</span></td><td colspan="2">MessageBox shown on error (GUI context)</td></tr>
  </table>
  <div class="code-block"><span class="tp">string</span> result = <span class="fn">ConnectedShop.JobsAddUpdateJob</span>(json, <span class="kw">false</span>);
<span class="kw">if</span> (<span class="tp">Guid</span>.<span class="fn">TryParse</span>(result, <span class="kw">out</span> _))
    <span class="cm">// Success ‚Äî result is the new Job GUID</span>
<span class="kw">else</span>
    <span class="fn">Console.WriteLine</span>(<span class="str">$"Error: {result}"</span>);</div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CONNECTEDSHOP CORE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="connectedshop">
  <h2 class="section-title"><span class="section-icon">‚öôÔ∏è</span>ConnectedShop ‚Äî Core</h2>
  <div class="method-grid">

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">Init</span><span class="method-desc">Initialize the API</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">connectionString</td><td class="param-type">string</td><td class="param-desc">SQL Server connection string</td></tr>
          <tr><td class="param-name">currentUserPk</td><td class="param-type">string</td><td class="param-desc">User GUID (empty = default)</td></tr>
          <tr><td class="param-name">currentRegion</td><td class="param-type">string</td><td class="param-desc">Locale e.g. "en-us"</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">bool</span> ok = <span class="fn">ConnectedShop.Init</span>(
    <span class="str">"Data Source=srv;Initial Catalog=MXP;Integrated Security=True;"</span>,
    <span class="str">""</span>,
    <span class="str">"en-us"</span>
);</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-void">void</span><span class="method-name">Shutdown</span><span class="method-desc">Release API resources</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <p>Releases all resources. Call after all operations are complete.</p>
        <div class="code-block"><span class="fn">ConnectedShop.Shutdown</span>();</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">SetToken</span><span class="method-desc">Set authorization token</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">token</td><td class="param-type">string</td><td class="param-desc">Authorization token</td></tr>
        </table>
        <div class="info-box note"><div class="label">Note</div>The only method that bypasses authorization checks.</div>
        <div class="code-block"><span class="fn">ConnectedShop.SetToken</span>(<span class="str">"your-token"</span>);</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">SwitchUser</span><span class="method-desc">Switch current user context</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">currentUserPk</td><td class="param-type">string</td><td class="param-desc">GUID of user to switch to</td></tr>
        </table>
        <div class="code-block"><span class="tp">string</span> res = <span class="fn">ConnectedShop.SwitchUser</span>(<span class="str">"user-guid"</span>);</div>
      </div>
    </div>

  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ALLOCATE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="allocate">
  <h2 class="section-title"><span class="section-icon">üéØ</span>Allocate</h2>
  <p>Stock allocation and deallocation against BOM nodes and jobs.</p>
  <div class="method-grid">

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-void">void</span><span class="method-name">AllocateStock</span><span class="method-desc">Allocate stock to a BOM node</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">typeAlloc</td><td class="param-type">int</td><td class="param-desc">Allocation type (1=hard allocation)</td></tr>
          <tr><td class="param-name">traceid</td><td class="param-type">string</td><td class="param-desc">Batch/trace GUID</td></tr>
          <tr><td class="param-name">progName</td><td class="param-type">string</td><td class="param-desc">Program name</td></tr>
          <tr><td class="param-name">repeatId</td><td class="param-type">int</td><td class="param-desc">Repeat identifier</td></tr>
          <tr><td class="param-name">qtyInProc</td><td class="param-type">int</td><td class="param-desc">Quantity in process</td></tr>
          <tr><td class="param-name">bomid</td><td class="param-type">string</td><td class="param-desc">Material BOM node GUID</td></tr>
          <tr><td class="param-name">partName</td><td class="param-type">string</td><td class="param-desc">Part name</td></tr>
          <tr><td class="param-name">taskName</td><td class="param-type">string</td><td class="param-desc">Task/operation name</td></tr>
          <tr><td class="param-name">AWo</td><td class="param-type">string</td><td class="param-desc">Work order number</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="kw">int</span> allocationType = <span class="num">1</span>; <span class="cm">// hard allocation</span>
<span class="tp">string</span> traceId = prodTrace.PK_PRODUCT_TRACE.ToString();
<span class="tp">string</span> programName = <span class="tp">string</span>.Empty;
<span class="kw">int</span> repeatId = <span class="num">0</span>;
<span class="kw">int</span> quantityInProc = <span class="num">12</span>;
<span class="tp">string</span> bomId = bomJob.PK_BOM_JOB.ToString(); <span class="cm">// materialBOMNode</span>

<span class="fn">ConnectedShop.AllocateStock</span>(
    allocationType, traceId, programName, repeatId,
    quantityInProc, bomId,
    <span class="tp">string</span>.Empty,  <span class="cm">// partName</span>
    <span class="tp">string</span>.Empty,  <span class="cm">// taskName</span>
    <span class="tp">string</span>.Empty   <span class="cm">// aWorkOrder</span>
);
<span class="cm">// Verify: MRP_ALLOCATED_STOCK_LINK row created with STOCK_QTY == 12</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-void">void</span><span class="method-name">AllocateDeallocate</span><span class="method-desc">Remove allocation from BOM node</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">traceid</td><td class="param-type">string</td><td class="param-desc">Batch/trace GUID to deallocate</td></tr>
          <tr><td class="param-name">bomid</td><td class="param-type">string</td><td class="param-desc">Material BOM node GUID</td></tr>
          <tr><td class="param-name">progName</td><td class="param-type">string</td><td class="param-desc">Program name</td></tr>
          <tr><td class="param-name">repeatId</td><td class="param-type">int</td><td class="param-desc">Repeat identifier</td></tr>
          <tr><td class="param-name">archivePacketID</td><td class="param-type">int</td><td class="param-desc">Archive packet ID</td></tr>
          <tr><td class="param-name">appName</td><td class="param-type">string</td><td class="param-desc">Calling application name</td></tr>
          <tr><td class="param-name">funcDesc</td><td class="param-type">string</td><td class="param-desc">Function description for audit</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">string</span> bomId   = bomJob.PK_BOM_JOB.ToString();
<span class="tp">string</span> traceId = prodTrace.PK_PRODUCT_TRACE.ToString();

<span class="fn">ConnectedShop.AllocateDeallocate</span>(
    traceId, bomId,
    <span class="tp">string</span>.Empty,   <span class="cm">// programName</span>
    <span class="num">0</span>,              <span class="cm">// repeatId</span>
    <span class="num">0</span>,              <span class="cm">// archivePacketId</span>
    <span class="str">""</span>,             <span class="cm">// appName</span>
    <span class="str">""</span>              <span class="cm">// funcDesc</span>
);
<span class="cm">// Verify: MRP_ALLOCATED_STOCK_LINK row is gone</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string (JSON)</span><span class="method-name">AllocateToJob</span><span class="method-desc">Allocate batches across a job</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">batchIds</td><td class="param-type">string</td><td class="param-desc">Comma-separated batch GUIDs</td></tr>
          <tr><td class="param-name">jobId</td><td class="param-type">string</td><td class="param-desc">Target job GUID</td></tr>
          <tr><td class="param-name">allocType</td><td class="param-type">int</td><td class="param-desc">Allocation type code</td></tr>
          <tr><td class="param-name">batchMaxQty</td><td class="param-type">string</td><td class="param-desc">Max qty per batch (empty = no limit)</td></tr>
          <tr><td class="param-name">userName</td><td class="param-type">string</td><td class="param-desc">User performing allocation</td></tr>
          <tr><td class="param-name">directType</td><td class="param-type">int</td><td class="param-desc">Direct allocation type</td></tr>
          <tr><td class="param-name">metaData</td><td class="param-type">string</td><td class="param-desc">Additional metadata JSON</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// batchIds: comma-separated GUIDs of 3 batches</span>
<span class="tp">string</span> batchIds = bchTrace1.PK_PRODUCT_TRACE + <span class="str">","</span>
                 + bchTrace2.PK_PRODUCT_TRACE + <span class="str">","</span>
                 + bchTrace3.PK_PRODUCT_TRACE;

<span class="tp">string</span> res = <span class="fn">ConnectedShopAPI.ConnectedShop.AllocateToJob</span>(
    batchIds,
    job.PK_JOBS.ToString(),
    <span class="num">1</span>,          <span class="cm">// allocType</span>
    <span class="str">""</span>,         <span class="cm">// batchMaxQty</span>
    <span class="str">"yuritest"</span>, <span class="cm">// userName</span>
    <span class="num">2</span>,          <span class="cm">// directType</span>
    <span class="str">""</span>          <span class="cm">// metaData</span>
);
<span class="cm">// Success: res contains "success"</span>
<span class="kw">if</span> (res.<span class="fn">IndexOf</span>(<span class="str">"success"</span>) >= <span class="num">0</span>)
    <span class="fn">Console.WriteLine</span>(<span class="str">"Allocated: "</span> + res);</div>
      </div>
    </div>

  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê APPROVAL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="approval">
  <h2 class="section-title"><span class="section-icon">‚úÖ</span>Approval</h2>
  <p>Job and PO approval workflow ‚Äî validation, level checking, and email notifications.</p>
  <div class="method-grid">

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">ApprovalValidateApprovalRulesForJob</span><span class="method-desc">Validate job approval rules</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">jobId</td><td class="param-type">string</td><td class="param-desc">Job GUID</td></tr>
          <tr><td class="param-name">includeCurrentJobWIP</td><td class="param-type">bool</td><td class="param-desc">Include WIP in validation</td></tr>
          <tr><td class="param-name">result<span class="out-badge">out</span></td><td class="param-type">string (JSON)</td><td class="param-desc">List of failed approval rules as JSON</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">string</span> jobId = <span class="str">"F1FD5AE0-1FAD-4FAA-A35E-7A290B449A0B"</span>;
<span class="tp">string</span> resultOutput = <span class="tp">string</span>.Empty;

<span class="tp">bool</span> value = <span class="fn">ConnectedShop.ApprovalValidateApprovalRulesForJob</span>(
    jobId,
    <span class="kw">false</span>,          <span class="cm">// includeCurrentJobWIP</span>
    <span class="kw">out</span> resultOutput
);

<span class="cm">// resultOutput contains JSON list of failed ApprovalRulesModel</span>
<span class="tp">List</span>&lt;<span class="tp">ApprovalRulesModel</span>&gt; failedRules =
    <span class="tp">JsonConvert</span>.<span class="fn">DeserializeObject</span>&lt;<span class="tp">List</span>&lt;<span class="tp">ApprovalRulesModel</span>&gt;&gt;(resultOutput);</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">ApprovalValidateApprovalRulesForPO</span><span class="method-desc">Validate PO approval rules</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">poId</td><td class="param-type">string</td><td class="param-desc">PO GUID</td></tr>
          <tr><td class="param-name">result<span class="out-badge">out</span></td><td class="param-type">string (JSON)</td><td class="param-desc">List of failed approval rules as JSON</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">string</span> resultOutput = <span class="tp">string</span>.Empty;
<span class="tp">string</span> poId = po.PK_PO.ToString();  <span class="cm">// find PO-1</span>

<span class="tp">bool</span> value = <span class="fn">ConnectedShop.ApprovalValidateApprovalRulesForPO</span>(
    poId, <span class="kw">out</span> resultOutput
);
<span class="tp">List</span>&lt;<span class="tp">ApprovalRulesModel</span>&gt; failedRules =
    <span class="tp">JsonConvert</span>.<span class="fn">DeserializeObject</span>&lt;<span class="tp">List</span>&lt;<span class="tp">ApprovalRulesModel</span>&gt;&gt;(resultOutput);</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-int">int</span><span class="method-name">ApprovalGetMaxApprovalLevelRequiredForJob</span><span class="method-desc">Get max approval level needed for job</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">jobId</td><td class="param-type">string</td><td class="param-desc">Job GUID</td></tr>
          <tr><td class="param-name">includeCurrentJobWIP</td><td class="param-type">bool</td><td class="param-desc">Include WIP in calculation</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">string</span> jobId = <span class="str">"F1FD5AE0-1FAD-4FAA-A35E-7A290B449A0B"</span>;
<span class="kw">int</span> level = <span class="fn">ConnectedShop.ApprovalGetMaxApprovalLevelRequiredForJob</span>(
    jobId, <span class="kw">false</span>
);
<span class="cm">// Returns 1 ‚Äî level 1 approval is required</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-int">int</span><span class="method-name">ApprovalGetMaxApprovalLevelRequiredForPO</span><span class="method-desc">Get max approval level needed for PO</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">poId</td><td class="param-type">string</td><td class="param-desc">PO GUID</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="kw">int</span> level = <span class="fn">ConnectedShop.ApprovalGetMaxApprovalLevelRequiredForPO</span>(
    po.PK_PO.ToString()
);
<span class="cm">// Returns 1</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">ApprovalValidatePriorApprovalForJob</span><span class="method-desc">Check if prior approvals are still valid</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">jobId</td><td class="param-type">string</td><td class="param-desc">Job GUID</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">string</span> jobId = <span class="str">"41A9DA8B-5AC5-47E7-BE8F-23CEBBFDD0B4"</span>;
<span class="tp">bool</span> response = <span class="fn">ConnectedShop.ApprovalValidatePriorApprovalForJob</span>(jobId);
<span class="cm">// true  = approval checkpoints are still consistent
// false = an approved rule has been violated (needs re-approval)</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">ApprovalValidatePriorApprovalForPO</span><span class="method-desc">Check if prior PO approvals are still valid</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">poId</td><td class="param-type">string</td><td class="param-desc">PO GUID</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">bool</span> response = <span class="fn">ConnectedShop.ApprovalValidatePriorApprovalForPO</span>(
    po.PK_PO.ToString()  <span class="cm">// find PO-2</span>
);</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">ApprovalSendApprovalRequestEmailJob</span><span class="method-desc">Send job approval request email</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">jobId</td><td class="param-type">string</td><td class="param-desc">Job GUID</td></tr>
          <tr><td class="param-name">requestedById</td><td class="param-type">string</td><td class="param-desc">Requesting user GUID</td></tr>
          <tr><td class="param-name">emailNote</td><td class="param-type">string</td><td class="param-desc">Custom note in email body</td></tr>
          <tr><td class="param-name">eventString</td><td class="param-type">string</td><td class="param-desc">Event context string</td></tr>
          <tr><td class="param-name">maxAndHigher</td><td class="param-type">bool</td><td class="param-desc">Send to max level approvers and above</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">string</span> jobId      = <span class="str">"41A9DA8B-5AC5-47E7-BE8F-23CEBBFDD0B4"</span>;
<span class="tp">string</span> emailNote  = <span class="str">"Please review this job for approval."</span>;
<span class="tp">string</span> eventStr   = <span class="str">"StatusChange"</span>;

<span class="tp">bool</span> response = <span class="fn">ConnectedShop.ApprovalSendApprovalRequestEmailJob</span>(
    jobId,
    user.PK_USERS.ToString(),  <span class="cm">// user with LOG_NAME == "subhan"</span>
    emailNote,
    eventStr,
    <span class="kw">true</span>                       <span class="cm">// maxAndHigher</span>
);</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">ApprovalSendApprovalRequestEmailPO</span><span class="method-desc">Send PO approval request email</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">poId</td><td class="param-type">string</td><td class="param-desc">PO GUID</td></tr>
          <tr><td class="param-name">requestedById</td><td class="param-type">string</td><td class="param-desc">Requesting user GUID</td></tr>
          <tr><td class="param-name">emailNote</td><td class="param-type">string</td><td class="param-desc">Custom note in email body</td></tr>
          <tr><td class="param-name">eventString</td><td class="param-type">string</td><td class="param-desc">Event context string</td></tr>
          <tr><td class="param-name">maxAndHigher</td><td class="param-type">bool</td><td class="param-desc">Send to max level approvers and above</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">bool</span> response = <span class="fn">ConnectedShop.ApprovalSendApprovalRequestEmailPO</span>(
    po.PK_PO.ToString(),      <span class="cm">// find PO-1</span>
    user.PK_USERS.ToString(), <span class="cm">// user "subhan"</span>
    <span class="str">"Please review this PO."</span>,
    <span class="str">"StatusChange"</span>,
    <span class="kw">true</span>
);</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">ApprovalSendApprovalConfirmationEmailJob</span><span class="method-desc">Send job approval confirmation email</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">jobId</td><td class="param-type">string</td><td class="param-desc">Job GUID</td></tr>
          <tr><td class="param-name">approvedBy</td><td class="param-type">string</td><td class="param-desc">Approver username or GUID</td></tr>
          <tr><td class="param-name">maxAndHigher</td><td class="param-type">bool</td><td class="param-desc">Notify max level and above</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">string</span> jobId      = <span class="str">"41A9DA8B-5AC5-47E7-BE8F-23CEBBFDD0B4"</span>;
<span class="tp">string</span> approvedBy = <span class="str">"subhan"</span>;
<span class="tp">bool</span> response = <span class="fn">ConnectedShop.ApprovalSendApprovalConfirmationEmailJob</span>(
    jobId, approvedBy, <span class="kw">true</span>
);</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">ApprovalSendApprovalConfirmationEmailPO</span><span class="method-desc">Send PO approval confirmation email</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">poId</td><td class="param-type">string</td><td class="param-desc">PO GUID</td></tr>
          <tr><td class="param-name">approvedBy</td><td class="param-type">string</td><td class="param-desc">Approver username or GUID</td></tr>
          <tr><td class="param-name">maxAndHigher</td><td class="param-type">bool</td><td class="param-desc">Notify max level and above</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">bool</span> response = <span class="fn">ConnectedShop.ApprovalSendApprovalConfirmationEmailPO</span>(
    po.PK_PO.ToString(), <span class="cm">// find PO-1</span>
    <span class="str">"subhan"</span>,
    <span class="kw">true</span>
);</div>
      </div>
    </div>

  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ASSEMBLIES ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="assemblies">
  <h2 class="section-title"><span class="section-icon">üîß</span>Assemblies</h2>
  <p>BOM assembly cost calculation and management.</p>
  <div class="method-grid">

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">AssembliesCalculateAssembly</span><span class="method-desc">Calculate full assembly cost</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">headerId</td><td class="param-type">string</td><td class="param-desc">Assembly header GUID</td></tr>
          <tr><td class="param-name">batch</td><td class="param-type">int</td><td class="param-desc">Batch quantity for costing</td></tr>
          <tr><td class="param-name">doCalcScriptStr</td><td class="param-type">string</td><td class="param-desc">Calculation script flags (empty = default)</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// header = assembly with HEADER_PART_CODE == "testprofile"</span>
<span class="fn">ConnectedShopAPI.ConnectedShop.AssembliesCalculateAssembly</span>(
    header.PK_BOM_HEADER.ToString(), <span class="num">2</span>, <span class="str">""</span>
);

<span class="cm">// Adjust an operation cost by +20, then recalculate batch=1</span>
oper.FIXED_COST = (oper.FIXED_COST ?? <span class="num">0</span>) + (<span class="kw">decimal</span>)<span class="num">20.0</span>;
cbojRep.<span class="fn">Put</span>(oper);

<span class="fn">ConnectedShopAPI.ConnectedShop.AssembliesCalculateAssembly</span>(
    header.PK_BOM_HEADER.ToString(), <span class="num">1</span>, <span class="str">""</span>
);
<span class="cm">// Verify: header.TOTAL_COST increased by 20</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">AssembliesCalculateSingleBOMItemCost</span><span class="method-desc">Calculate cost for one BOM item</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">pkBomHeader</td><td class="param-type">string</td><td class="param-desc">BOM header GUID</td></tr>
          <tr><td class="param-name">pkBOM</td><td class="param-type">string</td><td class="param-desc">BOM line GUID</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// header = assembly "Assembly_26090218"</span>
<span class="tp">string</span> pkBom = parentNode.PK_BOM.ToString();
<span class="tp">string</span> pkBomHeader = parentNode.SK_BOM_HEADER.ToString();

<span class="tp">bool</span> ok = <span class="fn">ConnectedShopAPI.ConnectedShop.AssembliesCalculateSingleBOMItemCost</span>(
    pkBomHeader, pkBom
);</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">AssembliesUpdateBOMHeader</span><span class="method-desc">Update assembly header totals</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">headerId</td><td class="param-type">string</td><td class="param-desc">Assembly header GUID</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// header PK: 8E00DC33-BA47-4E92-9F1E-A6AC184A0448</span>
<span class="tp">bool</span> ok = <span class="fn">ConnectedShopAPI.ConnectedShop.AssembliesUpdateBOMHeader</span>(
    header.PK_BOM_HEADER.ToString()
);</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">Tuple&lt;float,float,bool&gt;</span><span class="method-name">AssembliesCalculateAssemblyByHeader</span><span class="method-desc">Calculate assembly by name/description/revision</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">headerName</td><td class="param-type">string</td><td class="param-desc">Assembly header part code</td></tr>
          <tr><td class="param-name">description</td><td class="param-type">string</td><td class="param-desc">Assembly description</td></tr>
          <tr><td class="param-name">revision</td><td class="param-type">string</td><td class="param-desc">Revision identifier</td></tr>
          <tr><td class="param-name">batch</td><td class="param-type">int</td><td class="param-desc">Batch quantity</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// header PK: 8E00DC33-BA47-4E92-9F1E-A6AC184A0448</span>
<span class="tp">string</span> headerName  = header.HEADER_PART_CODE;
<span class="tp">string</span> description = header.HEADER_DESCRIPTION;
<span class="tp">string</span> revision    = header.REVISION;
<span class="kw">int</span> batch = <span class="num">1</span>;

<span class="tp">Tuple</span>&lt;<span class="kw">float</span>, <span class="kw">float</span>, <span class="kw">bool</span>&gt; results =
    <span class="fn">ConnectedShopAPI.ConnectedShop.AssembliesCalculateAssemblyByHeader</span>(
        headerName, description, revision, batch
    );
<span class="cm">// Item1 = costPrice, Item2 = sellPrice, Item3 = success</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-void">void</span><span class="method-name">AssembliesCopySubAssembly</span><span class="method-desc">Copy assembly node into a job</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">jobId</td><td class="param-type">string</td><td class="param-desc">Target job GUID</td></tr>
          <tr><td class="param-name">pkHeader</td><td class="param-type">string</td><td class="param-desc">Source assembly header GUID</td></tr>
          <tr><td class="param-name">jobItemId</td><td class="param-type">string</td><td class="param-desc">Target job item GUID</td></tr>
          <tr><td class="param-name">pkBOM</td><td class="param-type">string</td><td class="param-desc">BOM line to copy GUID</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// job-26, assembly "ASSEM_3009_1124", item "IM_30092025_1122"</span>
<span class="fn">ConnectedShopAPI.ConnectedShop.AssembliesCopySubAssembly</span>(
    jobs.PK_JOBS.ToString(),          <span class="cm">// job-26</span>
    bomHeader.PK_BOM_HEADER.ToString(), <span class="cm">// ASSEM_3009_1124</span>
    jobItem.PK_JOB_ITEMS.ToString(),    <span class="cm">// IM_30092025_1122 line</span>
    mrpBomJob.PK_BOM.ToString()         <span class="cm">// BOM_TYPE==2 node</span>
);
<span class="cm">// Verify: new BOM_TYPE==2 node added under bomHeader</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-intptr">IntPtr</span><span class="method-name">AssembliesReportAssemblyProblems</span><span class="method-desc">Get assembly validation issues</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">asmID</td><td class="param-type">string</td><td class="param-desc">Assembly header GUID</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">string</span> assemblyId = <span class="kw">new</span> <span class="tp">Guid</span>(<span class="str">"BF9CCF5C-4EFE-4BBC-AA41-457481F71CA7"</span>).ToString();
<span class="tp">IntPtr</span> output = <span class="fn">ConnectedShopAPI.ConnectedShop.AssembliesReportAssemblyProblems</span>(assemblyId);
<span class="tp">string</span> problems = <span class="tp">Marshal</span>.<span class="fn">PtrToStringUni</span>(output);
<span class="kw">if</span> (<span class="tp">string</span>.<span class="fn">IsNullOrEmpty</span>(problems))
    <span class="fn">Console.WriteLine</span>(<span class="str">"No problems found"</span>);
<span class="kw">else</span>
    <span class="fn">Console.WriteLine</span>(<span class="str">"Problems: "</span> + problems);</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-intptr">IntPtr</span><span class="method-name">AssembliesReportJobAssemblyProblems</span><span class="method-desc">Get job assembly validation issues</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">asmID</td><td class="param-type">string</td><td class="param-desc">Job item GUID (PK_JOB_ITEMS)</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// PK_JOB_ITEMS for JOB-26</span>
<span class="tp">string</span> asmId = <span class="kw">new</span> <span class="tp">Guid</span>(<span class="str">"CDEDF972-BB65-4AFF-8EC7-34262556B7C4"</span>).ToString();
<span class="tp">IntPtr</span> output = <span class="fn">ConnectedShopAPI.ConnectedShop.AssembliesReportJobAssemblyProblems</span>(asmId);
<span class="tp">string</span> problems = <span class="tp">Marshal</span>.<span class="fn">PtrToStringUni</span>(output);</div>
      </div>
    </div>

  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê BATCH ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="batch">
  <h2 class="section-title"><span class="section-icon">üì¶</span>Batch</h2>
  <p>Batch and stock management ‚Äî book-ins, quantity adjustments, splits, and Item Master management.</p>
  <div class="method-grid">

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">BatchAdjustBatchQuantity</span><span class="method-desc">Add or remove qty from a batch</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">aResult<span class="out-badge">out</span></td><td class="param-type">string</td><td class="param-desc">Result/error message</td></tr>
          <tr><td class="param-name">aPK_PRODUCT_TRACE</td><td class="param-type">string</td><td class="param-desc">Batch GUID</td></tr>
          <tr><td class="param-name">aEditQuantity</td><td class="param-type">int</td><td class="param-desc">Quantity to add or remove</td></tr>
          <tr><td class="param-name">aIsRemoveStock</td><td class="param-type">bool</td><td class="param-desc"><code>false</code> = add stock, <code>true</code> = remove stock</td></tr>
          <tr><td class="param-name">aIsAdjustAvailableQty</td><td class="param-type">bool</td><td class="param-desc">Adjust available (not total) qty</td></tr>
          <tr><td class="param-name">aReason</td><td class="param-type">string</td><td class="param-desc">Reason for adjustment</td></tr>
          <tr><td class="param-name">aNotes</td><td class="param-type">string</td><td class="param-desc">Additional notes</td></tr>
        </table>
        <div class="code-label">Unit Test Example ‚Äî Add 5, then Remove 2</div>
        <div class="code-block"><span class="tp">string</span> resultVal;
<span class="tp">Guid</span> traceGuid = <span class="tp">Guid</span>.<span class="fn">Parse</span>(<span class="str">"E838473B-E334-4512-B50A-600DD1117413"</span>);

<span class="cm">// Add 5 units</span>
<span class="fn">ConnectedShop.BatchAdjustBatchQuantity</span>(
    <span class="kw">out</span> resultVal,
    traceGuid.ToString(),
    <span class="num">5</span>,
    <span class="kw">false</span>,   <span class="cm">// isRemoveStock = false ‚Üí add</span>
    <span class="kw">false</span>,   <span class="cm">// isAdjustAvailableQty</span>
    <span class="str">"Any reason test"</span>,
    <span class="str">""</span>
);
<span class="cm">// Verify: QTY_BOOKED increased by 5</span>

<span class="cm">// Remove 2 units</span>
<span class="fn">ConnectedShop.BatchAdjustBatchQuantity</span>(
    <span class="kw">out</span> resultVal,
    traceGuid.ToString(),
    <span class="num">2</span>,
    <span class="kw">true</span>,    <span class="cm">// isRemoveStock = true ‚Üí remove</span>
    <span class="kw">false</span>,
    <span class="str">"Any reason test"</span>,
    <span class="str">""</span>
);
<span class="cm">// Verify: QTY_BOOKED decreased by 2</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string (GUID)</span><span class="method-name">BatchAddUpdateIM</span><span class="method-desc">Add or update Item Master sheet</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">product</td><td class="param-type">string (JSON)</td><td class="param-desc">ProductItem model as JSON</td></tr>
          <tr><td class="param-name">stock</td><td class="param-type">string (JSON)</td><td class="param-desc">ProductStock model as JSON</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">ProductItem</span> prod = <span class="kw">new</span> <span class="tp">ProductItem</span>();
prod.FK_PRODUCT_MATERIAL = mat.MaterialUniqueID;  <span class="cm">// material "MS"</span>
prod.THICKNESS = (<span class="kw">decimal</span>)<span class="num">0.3</span>;
prod.W         = <span class="num">10</span>;
prod.L         = <span class="num">20</span>;
prod.ITEM_TYPE = <span class="str">"SigmaSheet"</span>;
prod.ITEM_COST = <span class="num">77</span>;
prod.PART_CODE = <span class="str">"MainTestSheet"</span>;
prod.DESCRIPTION = <span class="str">"Main IM test item"</span>;

<span class="tp">ProductStock</span> stock = <span class="kw">new</span> <span class="tp">ProductStock</span>();

<span class="tp">string</span> newGuid = <span class="fn">ConnectedShop.BatchAddUpdateIM</span>(
    <span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(prod),
    <span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(stock)
);
<span class="cm">// Returns GUID of created/updated Item Master</span>
<span class="tp">Guid</span> g;
<span class="kw">if</span> (<span class="tp">Guid</span>.<span class="fn">TryParse</span>(newGuid, <span class="kw">out</span> g))
    <span class="fn">Console.WriteLine</span>(<span class="str">"Created IM: "</span> + g);</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string (GUID)</span><span class="method-name">BatchBookIn</span><span class="method-desc">Book a batch into inventory</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">batch</td><td class="param-type">string (JSON)</td><td class="param-desc">ProductTrace model as JSON</td></tr>
          <tr><td class="param-name">userId</td><td class="param-type">string</td><td class="param-desc">User GUID performing book-in</td></tr>
          <tr><td class="param-name">onlyLocation</td><td class="param-type">bool</td><td class="param-desc"><code>true</code> = update location only, no qty change</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">ProductTrace</span> trace = <span class="kw">new</span> <span class="tp">ProductTrace</span>();
trace.FK_PRODUCT_ITEM = im.PK_PRODUCT_ITEM; <span class="cm">// IM "MainTestSheet"</span>
trace.QTY_BOOKED = <span class="num">2</span>;
trace.NAME       = <span class="str">"BCH-11"</span>;
trace.Location   = whs.WHS_NAME;  <span class="cm">// "Stores A"</span>

<span class="tp">Guid</span> userId = userRep.<span class="fn">Get</span>().<span class="fn">FirstOrDefault</span>().PK_USERS;
<span class="tp">string</span> result = <span class="fn">ConnectedShop.BatchBookIn</span>(
    <span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(trace),
    userId.ToString(),
    <span class="kw">false</span>  <span class="cm">// onlyLocation</span>
);
<span class="cm">// Returns GUID of the created batch record</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">BatchBookInFromJob</span><span class="method-desc">Book finished goods in from a job</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">jobid</td><td class="param-type">string</td><td class="param-desc">Completed job GUID</td></tr>
          <tr><td class="param-name">location</td><td class="param-type">string</td><td class="param-desc">Target warehouse location name</td></tr>
          <tr><td class="param-name">userId</td><td class="param-type">string</td><td class="param-desc">User GUID</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// firsJob = job with JobNoInt == 4, whs = "Stores A"</span>
<span class="tp">Guid</span> userId = userRep.<span class="fn">Get</span>().<span class="fn">FirstOrDefault</span>().PK_USERS;
<span class="tp">string</span> result = <span class="fn">ConnectedShop.BatchBookInFromJob</span>(
    firsJob.PK_JOBS.ToString(),
    whs.WHS_NAME,    <span class="cm">// "Stores A"</span>
    userId.ToString()
);
<span class="cm">// Success: result == "" (empty string)</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">BatchBookInFromGRN</span><span class="method-desc">Book items in from a GRN</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">grnid</td><td class="param-type">string</td><td class="param-desc">GRN document GUID</td></tr>
          <tr><td class="param-name">location</td><td class="param-type">string</td><td class="param-desc">Target warehouse location name</td></tr>
          <tr><td class="param-name">userId</td><td class="param-type">string</td><td class="param-desc">User GUID</td></tr>
        </table>
        <div class="code-block"><span class="tp">string</span> result = <span class="fn">ConnectedShop.BatchBookInFromGRN</span>(
    grnDoc.PK_DOCUMENT_HEADER.ToString(),
    <span class="str">"Stores A"</span>,
    userId.ToString()
);</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">BatchSplitBatchQuantity</span><span class="method-desc">Split batch into a new child batch</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">aResult<span class="out-badge">out</span></td><td class="param-type">string</td><td class="param-desc">Result/error message</td></tr>
          <tr><td class="param-name">aPK_PRODUCT_TRACE</td><td class="param-type">string</td><td class="param-desc">Source batch GUID</td></tr>
          <tr><td class="param-name">aEditQuantity</td><td class="param-type">int</td><td class="param-desc">Quantity to split off</td></tr>
          <tr><td class="param-name">aPK_WHS</td><td class="param-type">string</td><td class="param-desc">Warehouse location GUID for new batch</td></tr>
        </table>
        <div class="code-block"><span class="tp">string</span> resultVal;
<span class="tp">bool</span> ok = <span class="fn">ConnectedShop.BatchSplitBatchQuantity</span>(
    <span class="kw">out</span> resultVal,
    sourceBatch.PK_PRODUCT_TRACE.ToString(),
    <span class="num">3</span>,                  <span class="cm">// split off 3 units</span>
    whs.PK_WHS.ToString()
);</div>
      </div>
    </div>

  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CONTACT ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="contact">
  <h2 class="section-title"><span class="section-icon">üë§</span>Contact</h2>
  <p>Customer company and contact person management.</p>
  <div class="method-grid">

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">ContactAddCompanyAndContact</span><span class="method-desc">Create company with default contact</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">json</td><td class="param-type">string (JSON)</td><td class="param-desc">CustomerAndContactDataModel as JSON</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">CustomerAndContactDataModel</span> model = <span class="kw">new</span> <span class="tp">CustomerAndContactDataModel</span>();
model.CompanyName            = <span class="str">"Yuri Company"</span>;
model.ContactName            = <span class="str">"Yuri Vovchenko"</span>;
model.Address1               = <span class="str">"123 Nice Street"</span>;
model.City                   = <span class="str">"Cincinnati"</span>;
model.Country                = <span class="str">"United States"</span>;
model.DeliveryAddress        = <span class="str">"345 Delivery Str"</span>;
model.Custom7                = <span class="str">"This custom text"</span>;
model.Job_Title              = <span class="str">"Developer"</span>;
model.TaxRate                = <span class="str">"20"</span>;
model.CompanyType            = <span class="num">3</span>;
model.CompanyTypeDescription = <span class="str">"Customer"</span>;

<span class="tp">string</span> json   = <span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(model);
<span class="tp">string</span> result = <span class="fn">ConnectedShop.ContactAddCompanyAndContact</span>(json);
<span class="cm">// Success: result contains "contact added successfully"</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">ContactAddEditContact</span><span class="method-desc">Add or update a contact</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">json</td><td class="param-type">string (JSON)</td><td class="param-desc">CustomerAndContactDataModel as JSON</td></tr>
        </table>
        <div class="code-label">Unit Test Example ‚Äî Add new contact to existing company</div>
        <div class="code-block"><span class="tp">CustomerAndContactDataModel</span> model = <span class="kw">new</span> <span class="tp">CustomerAndContactDataModel</span>();
model.CompanyName = <span class="str">"Yuri Company"</span>;
model.ContactName = <span class="str">"Anton Vovchenko"</span>;

<span class="tp">string</span> result = <span class="fn">ConnectedShop.ContactAddEditContact</span>(
    <span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(model)
);
<span class="cm">// Success: result contains "ed new contact with ID"</span></div>
        <div class="code-label">Add contact with zero-tax address</div>
        <div class="code-block"><span class="cm">// Used by JobsChangeJobContact test to create a 0% tax contact</span>
<span class="tp">CustomerAndContactDataModel</span> model = <span class="kw">new</span> <span class="tp">CustomerAndContactDataModel</span>();
model.CompanyName  = <span class="str">"Yuri Company"</span>;
model.ContactName  = <span class="str">"Artem Vovchenko"</span>;
model.FK_TAX_RATE  = taxZero.PK_TAXRATE;
model.Address1     = <span class="str">"Columbus str."</span>;
model.TaxRate      = <span class="str">"0"</span>;
<span class="fn">ConnectedShop.ContactAddEditContact</span>(<span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(model));</div>
      </div>
    </div>

  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê COSTING ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="costing">
  <h2 class="section-title"><span class="section-icon">üí∞</span>Costing</h2>
  <p>Price, markup, GPM, and job cost calculations.</p>
  <div class="method-grid">

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-double">double</span><span class="method-name">CostingGetPriceFromMarkup</span><span class="method-desc">Price = cost √ó (1 + markup%/100)</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">markupPercent</td><td class="param-type">double</td><td class="param-desc">Markup percentage e.g. 25.0 for 25%</td></tr>
          <tr><td class="param-name">unitCost</td><td class="param-type">double</td><td class="param-desc">Base unit cost</td></tr>
        </table>
        <div class="code-block"><span class="tp">double</span> price = <span class="fn">ConnectedShop.CostingGetPriceFromMarkup</span>(<span class="num">25.0</span>, <span class="num">100.00</span>);
<span class="cm">// Returns 125.00</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-double">double</span><span class="method-name">CostingGetPriceFromGPM</span><span class="method-desc">Price = cost / (1 ‚àí GPM%/100)</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">GPMPercent</td><td class="param-type">double</td><td class="param-desc">Gross Profit Margin percentage</td></tr>
          <tr><td class="param-name">unitCost</td><td class="param-type">double</td><td class="param-desc">Base unit cost</td></tr>
        </table>
        <div class="code-block"><span class="tp">double</span> price = <span class="fn">ConnectedShop.CostingGetPriceFromGPM</span>(<span class="num">20.0</span>, <span class="num">100.00</span>);
<span class="cm">// Returns 125.00  (100 / 0.80)</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-double">double</span><span class="method-name">CostingGetGPM</span><span class="method-desc">Calculate GPM % from price and cost</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">price</td><td class="param-type">double</td><td class="param-desc">Selling price</td></tr>
          <tr><td class="param-name">unitCost</td><td class="param-type">double</td><td class="param-desc">Unit cost</td></tr>
        </table>
        <div class="code-block"><span class="tp">double</span> gpm = <span class="fn">ConnectedShop.CostingGetGPM</span>(<span class="num">125.0</span>, <span class="num">100.0</span>);
<span class="cm">// Returns 20.0 (%)</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-double">double</span><span class="method-name">CostingGetMarkup</span><span class="method-desc">Calculate markup % from price and cost</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">price</td><td class="param-type">double</td><td class="param-desc">Selling price</td></tr>
          <tr><td class="param-name">unitCost</td><td class="param-type">double</td><td class="param-desc">Unit cost</td></tr>
        </table>
        <div class="code-block"><span class="tp">double</span> markup = <span class="fn">ConnectedShop.CostingGetMarkup</span>(<span class="num">125.0</span>, <span class="num">100.0</span>);
<span class="cm">// Returns 25.0 (%)</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">CostingRecalcProductItem</span><span class="method-desc">Recalculate Item Master cost/price</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">pkIM</td><td class="param-type">string</td><td class="param-desc">Item Master GUID</td></tr>
          <tr><td class="param-name">recalcBasedOn</td><td class="param-type">int</td><td class="param-desc"><code>0</code>=material cost ¬∑ <code>1</code>=material price ¬∑ <code>2</code>=both</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// Setup: set material "MS" cost to 5/mm, modifier to 0.5</span>
mat.Costmm = <span class="num">5</span>;
matRep.<span class="fn">Put</span>(mat);
prodCosts.MODIFIER = <span class="num">0.5</span>;
prodCostsRep.<span class="fn">Put</span>(prodCosts);

<span class="cm">// Recalc based on material cost (recalcBasedOn=0)</span>
<span class="tp">string</span> result = <span class="fn">ConnectedShop.CostingRecalcProductItem</span>(
    pkIM.PK_PRODUCT_ITEM.ToString(),
    <span class="num">0</span>   <span class="cm">// based on material cost</span>
);
<span class="cm">// Success: result == "" (empty)
// Verify: ITEM_COST ‚âà 850.8</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">CostingCalculateJobItemBasedOnAlterPrice</span><span class="method-desc">Apply alternative pricing to a job item</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">pkJobItem</td><td class="param-type">string</td><td class="param-desc">Job item GUID</td></tr>
          <tr><td class="param-name">updateBomPrice</td><td class="param-type">bool</td><td class="param-desc">Also update associated BOM prices</td></tr>
        </table>
        <div class="code-block"><span class="tp">bool</span> ok = <span class="fn">ConnectedShop.CostingCalculateJobItemBasedOnAlterPrice</span>(
    jobItem.PK_JOB_ITEMS.ToString(),
    <span class="kw">true</span>  <span class="cm">// updateBomPrice</span>
);</div>
      </div>
    </div>

  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê DELIVERY NOTES ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="delivery-notes">
  <h2 class="section-title"><span class="section-icon">üöö</span>Delivery Notes</h2>
  <p>Create and manage delivery note documents from jobs.</p>
  <div class="method-grid">

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string (GUID)</span><span class="method-name">DeliveryNotesCreateDeliveryNoteFromJob</span><span class="method-desc">Create delivery note from job</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">id</td><td class="param-type">string</td><td class="param-desc">Job GUID</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// First move job to "Order" state</span>
<span class="fn">ConnectedShopAPI.ConnectedShop.JobsChangeJobState</span>(job.PK_JOBS.ToString(), <span class="num">30</span>);

<span class="tp">string</span> result = <span class="fn">ConnectedShopAPI.ConnectedShop.DeliveryNotesCreateDeliveryNoteFromJob</span>(
    job.PK_JOBS.ToString()  <span class="cm">// job JOB-1 version 1</span>
);
<span class="tp">Guid</span> g;
<span class="kw">if</span> (<span class="tp">Guid</span>.<span class="fn">TryParse</span>(result, <span class="kw">out</span> g))
{
    <span class="cm">// Verify delivery note document exists with correct delivery address</span>
    <span class="kw">var</span> doc = headerRep.<span class="fn">Get</span>(g);
    <span class="fn">Console.WriteLine</span>(doc.SUB_ADDRESS); <span class="cm">// should contain "Columbus"</span>
}</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">DeliveryNotesDocumentApplyTaxFromAddress</span><span class="method-desc">Apply tax rate from delivery address</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">pkId</td><td class="param-type">string</td><td class="param-desc">Delivery note document GUID</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// Set document's delivery address to a 0% tax contact
// (requires UseTaxDelivery system setting = true)</span>
doc.FK_Address_Contact = zeroCont.PK_CONTACT;
headersRep.<span class="fn">Put</span>(doc);

<span class="tp">bool</span> res = <span class="fn">ConnectedShopAPI.ConnectedShop.DeliveryNotesDocumentApplyTaxFromAddress</span>(
    doc.PK_DOCUMENT_HEADER.ToString()
);
<span class="cm">// Verify: doc.TAX_RATE changed from 20 ‚Üí 0</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">DeliveryNotesGetDocumentHeaderDetails</span><span class="method-desc">Get document header as JSON</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">docId</td><td class="param-type">string</td><td class="param-desc">Delivery note document GUID</td></tr>
          <tr><td class="param-name">result<span class="out-badge">out</span></td><td class="param-type">string (JSON)</td><td class="param-desc">Document header data as JSON</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// docId = GUID of delivery note "DEL-1"</span>
<span class="tp">string</span> resultOutput = <span class="tp">string</span>.Empty;
<span class="tp">bool</span> ok = <span class="fn">ConnectedShopAPI.ConnectedShop.DeliveryNotesGetDocumentHeaderDetails</span>(
    crmDocumentHeaderId, <span class="kw">out</span> resultOutput
);

<span class="tp">CRM_DOCUMENT_HEADER</span> header =
    <span class="tp">JsonConvert</span>.<span class="fn">DeserializeObject</span>&lt;<span class="tp">CRM_DOCUMENT_HEADER</span>&gt;(resultOutput);
<span class="cm">// Verify: header.FK_JOB matches JOB-1 version 1</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">DeliveryNotesGetDocumentItems</span><span class="method-desc">Get delivery note line items</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">docId</td><td class="param-type">string</td><td class="param-desc">Delivery note document GUID</td></tr>
          <tr><td class="param-name">jobId</td><td class="param-type">string</td><td class="param-desc">Associated job GUID</td></tr>
          <tr><td class="param-name">result<span class="out-badge">out</span></td><td class="param-type">string (JSON)</td><td class="param-desc">List of document line items as JSON</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// job = JobNoInt 30, find its delivery note header</span>
<span class="tp">string</span> resultOutput = <span class="tp">string</span>.Empty;
<span class="fn">ConnectedShopAPI.ConnectedShop.DeliveryNotesGetDocumentItems</span>(
    docHeader.PK_DOCUMENT_HEADER.ToString(),
    job.PK_JOBS.ToString(),
    <span class="kw">out</span> resultOutput
);

<span class="tp">List</span>&lt;<span class="tp">CRM_DOCUMENT_ITEMS</span>&gt; items =
    <span class="tp">JsonConvert</span>.<span class="fn">DeserializeObject</span>&lt;<span class="tp">List</span>&lt;<span class="tp">CRM_DOCUMENT_ITEMS</span>&gt;&gt;(resultOutput);
<span class="cm">// Verify: items[0].PARTCODE == "IM_241125-0300"</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">DeliveryNotesSaveDocumentDetails</span><span class="method-desc">Save document header and items</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">documentHeader</td><td class="param-type">string (JSON)</td><td class="param-desc">Document header data</td></tr>
          <tr><td class="param-name">documentItems</td><td class="param-type">string (JSON)</td><td class="param-desc">List of line items</td></tr>
          <tr><td class="param-name">pkHeader<span class="out-badge">out</span></td><td class="param-type">string</td><td class="param-desc">Saved document GUID</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// job = JobNoInt 31 ‚Äî build header and items from job data</span>
<span class="kw">var</span> newDocHeader = <span class="kw">new</span> <span class="tp">CRM_DOCUMENT_HEADER</span>();
newDocHeader.PK_DOCUMENT_HEADER = <span class="tp">Guid</span>.<span class="fn">NewGuid</span>();
newDocHeader.FK_JOB        = job.PK_JOBS;
newDocHeader.DOCUMENT_NO   = <span class="str">"NEW"</span>;
newDocHeader.DOCUMENT_TYPE = <span class="num">1</span>;  <span class="cm">// delivery note</span>
newDocHeader.CURRENCY      = job.CURRENCY;
newDocHeader.TOTAL_COST    = job.TOTAL_COST;
<span class="cm">// ... populate remaining fields from job ...</span>

<span class="cm">// Build doc items from job items</span>
<span class="kw">var</span> newDocItems = <span class="cm">/* list of CRM_DOCUMENT_ITEMS */</span>;

<span class="tp">string</span> pkHeader = <span class="tp">string</span>.Empty;
<span class="fn">ConnectedShopAPI.ConnectedShop.DeliveryNotesSaveDocumentDetails</span>(
    <span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(newDocHeader),
    <span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(newDocItems),
    <span class="kw">out</span> pkHeader
);
<span class="tp">Guid</span> newId = <span class="tp">Guid</span>.<span class="fn">Parse</span>(pkHeader);
<span class="cm">// Verify: document exists in DB with the returned GUID</span></div>
      </div>
    </div>

  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê EXPORT ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="export">
  <h2 class="section-title"><span class="section-icon">üì§</span>Export</h2>
  <div class="method-grid">
    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">ExportCSV</span><span class="method-desc">Export invoices or POs to CSV file</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">exportType</td><td class="param-type">int</td><td class="param-desc"><code>1</code> = Invoices ¬∑ <code>2</code> = Purchase Orders</td></tr>
          <tr><td class="param-name">fileName</td><td class="param-type">string</td><td class="param-desc">Output file path (supports %appdata%)</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// Export all POs to CSV</span>
<span class="tp">string</span> result = <span class="fn">ConnectedShop.ExportCSV</span>(<span class="num">2</span>, <span class="str">"%appdata%\\test.csv"</span>);
<span class="cm">// Success: result == "" (empty string)</span>

<span class="cm">// Export all Invoices</span>
result = <span class="fn">ConnectedShop.ExportCSV</span>(<span class="num">1</span>, <span class="str">@"C:\exports\invoices.csv"</span>);</div>
      </div>
    </div>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê INVOICE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="invoice">
  <h2 class="section-title"><span class="section-icon">üßæ</span>Invoice</h2>
  <p>Create invoices from delivery notes or directly from jobs.</p>
  <div class="method-grid">

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string (GUID)</span><span class="method-name">InvoicesCreateInvoiceFromDeliveryNote</span><span class="method-desc">Create invoice from delivery note</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">id</td><td class="param-type">string</td><td class="param-desc">Delivery Note document GUID</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// grn = document with DOCUMENT_NO == "DEL-1"</span>
<span class="tp">string</span> res = <span class="fn">ConnectedShopAPI.ConnectedShop.InvoicesCreateInvoiceFromDeliveryNote</span>(
    grn.PK_DOCUMENT_HEADER.ToString()
);
<span class="tp">Guid</span> invId;
<span class="kw">if</span> (<span class="tp">Guid</span>.<span class="fn">TryParse</span>(res, <span class="kw">out</span> invId))
{
    <span class="kw">var</span> invoice = headerRep.<span class="fn">Get</span>(invId);
    <span class="cm">// Verify: invoice.SUB_ADDRESS starts with "Columbus"</span>
}</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string (GUID)</span><span class="method-name">InvoicesCreateInvoiceFromJob</span><span class="method-desc">Create invoice directly from job</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">id</td><td class="param-type">string</td><td class="param-desc">Job GUID</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// job = job with JobNoInt == 3</span>
<span class="tp">string</span> res = <span class="fn">ConnectedShopAPI.ConnectedShop.InvoicesCreateInvoiceFromJob</span>(
    job.PK_JOBS.ToString()
);
<span class="tp">Guid</span> invId;
<span class="kw">if</span> (<span class="tp">Guid</span>.<span class="fn">TryParse</span>(res, <span class="kw">out</span> invId))
{
    <span class="kw">var</span> invoice   = headerRep.<span class="fn">Get</span>(invId);
    <span class="kw">var</span> lineItems = docItemsRep.<span class="fn">Get</span>().<span class="fn">Where</span>(x => x.FK_DOCUMENT_HEADER == invId).<span class="fn">ToList</span>();
    <span class="cm">// Verify: lineItems.Count == 2, invoice.TOTAL_COST >= 40</span>
}</div>
      </div>
    </div>

  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê JOBS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="jobs">
  <h2 class="section-title"><span class="section-icon">üìã</span>Jobs</h2>
  <p>Full job lifecycle management ‚Äî creation, status changes, calculations, and WIP.</p>
  <div class="method-grid">

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string (GUID)</span><span class="method-name">JobsAddUpdateJob</span><span class="method-desc">Create or update a job</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">json</td><td class="param-type">string (JSON)</td><td class="param-desc">Job model as JSON</td></tr>
          <tr><td class="param-name">applyContactPriceBreak</td><td class="param-type">bool</td><td class="param-desc">Apply contact-level price breaks</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">Job</span> model = <span class="kw">new</span> <span class="tp">Job</span>();
model.FK_CONTACT  = cont.PK_CONTACT;  <span class="cm">// contact "Yuri Vovchenko"</span>
model.FK_CUSTOMER = comp.PK_COMPANY;  <span class="cm">// company "Yuri Company"</span>
model.JOB_STATUS  = <span class="str">"Draft Quotation"</span>;
model.CURRENCY    = <span class="str">"USD"</span>;

<span class="tp">string</span> json   = <span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(model);
<span class="tp">string</span> jobId  = <span class="fn">ConnectedShop.JobsAddUpdateJob</span>(json, <span class="kw">false</span>);
<span class="cm">// Verify:
//   job.TAX_RATE == 20  (inherited from contact)
//   job.DELIVERY_ADDRESS contains "345 Delivery Str"
//   job.CUSTOMER_DESCRIPTION == "Yuri Company"</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">JobsChangeJobState</span><span class="method-desc">Change job status by numeric code</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">pkJob</td><td class="param-type">string</td><td class="param-desc">Job GUID</td></tr>
          <tr><td class="param-name">state</td><td class="param-type">int</td><td class="param-desc">Target status code</td></tr>
        </table>
        <table class="error-table" style="margin-top:0.5rem"><tr><th>Code</th><th>Status</th></tr>
          <tr><td class="code-val">10</td><td>Draft Quotation</td></tr>
          <tr><td class="code-val">20</td><td>Quotation</td></tr>
          <tr><td class="code-val">30</td><td>Order</td></tr>
          <tr><td class="code-val">40</td><td>In Production</td></tr>
          <tr><td class="code-val">50</td><td>Complete</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// job = JOB-1 version 1</span>
<span class="fn">ConnectedShopAPI.ConnectedShop.JobsChangeJobState</span>(
    job.PK_JOBS.ToString(),
    <span class="num">30</span>  <span class="cm">// ‚Üí "Order"</span>
);
<span class="cm">// Verify: job.JOB_STATUS == "Order"</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">JobsRejectJob</span><span class="method-desc">Reject a job</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">pkJob</td><td class="param-type">string</td><td class="param-desc">Job GUID</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// job = JOB-1 version 1</span>
<span class="fn">ConnectedShopAPI.ConnectedShop.JobsRejectJob</span>(job.PK_JOBS.ToString());
<span class="cm">// Verify: job.JOB_STATUS == "Rejected"</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-int">int</span><span class="method-name">JobsCopyJob</span><span class="method-desc">Copy a job with all line items</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">pk</td><td class="param-type">string</td><td class="param-desc">Source job GUID</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">string</span> result = <span class="fn">ConnectedShopAPI.ConnectedShop.JobsCopyJob</span>(
    job.PK_JOBS.ToString()
).ToString();
<span class="cm">// Verify: copied job exists with same DELIVERY_ADDRESS and FK_TAX_RATE</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string (GUID)</span><span class="method-name">JobsRevisionJob</span><span class="method-desc">Create a revision of a job</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">pk</td><td class="param-type">string</td><td class="param-desc">Source job GUID</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">string</span> result = <span class="fn">ConnectedShopAPI.ConnectedShop.JobsRevisionJob</span>(
    job.PK_JOBS.ToString()
);
<span class="cm">// Verify: new job exists with same JOB_NO but different JOB_VERSION</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">JobsChangeJobContact</span><span class="method-desc">Reassign job to different contact</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">pkJob</td><td class="param-type">string</td><td class="param-desc">Job GUID</td></tr>
          <tr><td class="param-name">pkContact</td><td class="param-type">string</td><td class="param-desc">New contact GUID</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// cont = "Artem Vovchenko" (has 0% tax, "Columbus str." address)</span>
<span class="tp">string</span> result = <span class="fn">ConnectedShopAPI.ConnectedShop.JobsChangeJobContact</span>(
    job.PK_JOBS.ToString(),  <span class="cm">// JOB-1 with non-zero tax</span>
    cont.PK_CONTACT.ToString()
);
<span class="cm">// Verify:
//   job.TAX_RATE == 0
//   job.FK_TAX_RATE == taxZero.PK_TAXRATE
//   job.DELIVERY_ADDRESS contains "Columbus"</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">JobsChangeJobAddress</span><span class="method-desc">Change job delivery or invoice address</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">pkJob</td><td class="param-type">string</td><td class="param-desc">Job GUID</td></tr>
          <tr><td class="param-name">pkAddress</td><td class="param-type">string</td><td class="param-desc">Address contact GUID</td></tr>
          <tr><td class="param-name">addressType</td><td class="param-type">int</td><td class="param-desc"><code>0</code> = delivery ¬∑ <code>1</code> = invoice</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// address = contact with ADDRESS_1 == "Address Contacts Street"</span>
<span class="tp">string</span> result = <span class="fn">ConnectedShopAPI.ConnectedShop.JobsChangeJobAddress</span>(
    job.PK_JOBS.ToString(),
    address.PK_CONTACT.ToString(),
    <span class="num">1</span>  <span class="cm">// invoice address</span>
);
<span class="cm">// Verify: job.INVOICE_ADDRESS contains "Address Contacts Street"</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">JobsChangeJobTaxRate</span><span class="method-desc">Change job tax rate</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">pkJob</td><td class="param-type">string</td><td class="param-desc">Job GUID</td></tr>
          <tr><td class="param-name">pkTaxRate</td><td class="param-type">string</td><td class="param-desc">Tax rate GUID</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// taxZero = tax rate record with TAX_RATE == 20.0</span>
<span class="fn">ConnectedShopAPI.ConnectedShop.JobsChangeJobTaxRate</span>(
    job.PK_JOBS.ToString(),       <span class="cm">// JOB-1 version 1</span>
    taxZero.PK_TAXRATE.ToString()
);
<span class="cm">// Verify: job.TAX_RATE == 20.0</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">JobsChangeJobDueDate</span><span class="method-desc">Change job due date</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">pkJob</td><td class="param-type">string</td><td class="param-desc">Job GUID</td></tr>
          <tr><td class="param-name">dt</td><td class="param-type">DateTime</td><td class="param-desc">New due date</td></tr>
          <tr><td class="param-name">applyToLines</td><td class="param-type">bool</td><td class="param-desc">Cascade change to all line items</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">DateTime</span> dt = <span class="kw">new</span> <span class="tp">DateTime</span>(<span class="num">2024</span>, <span class="num">5</span>, <span class="num">1</span>);
<span class="fn">ConnectedShopAPI.ConnectedShop.JobsChangeJobDueDate</span>(
    job.PK_JOBS.ToString(),  <span class="cm">// JOB-1 version 1</span>
    dt,
    <span class="kw">false</span>                    <span class="cm">// don't cascade to lines</span>
);
<span class="cm">// Verify: job.ORDER_DUE ‚âà 2024-05-01</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">JobsCalculateFullJob</span><span class="method-desc">Fully recalculate all job costs</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">pkJob</td><td class="param-type">string</td><td class="param-desc">Job GUID</td></tr>
          <tr><td class="param-name">doCalcScriptStr</td><td class="param-type">string</td><td class="param-desc">Calculation script flags (empty = default)</td></tr>
          <tr><td class="param-name">resetAll</td><td class="param-type">string</td><td class="param-desc">Reset all overrides before recalc</td></tr>
        </table>
        <div class="code-block"><span class="tp">bool</span> ok = <span class="fn">ConnectedShop.JobsCalculateFullJob</span>(
    job.PK_JOBS.ToString(), <span class="str">""</span>, <span class="str">""</span>
);</div>
      </div>
    </div>

  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê JOB ITEMS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="job-item">
  <h2 class="section-title"><span class="section-icon">üìù</span>Job Items</h2>
  <p>Add, update, and copy individual line items within a job.</p>
  <div class="method-grid">

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string (GUID)</span><span class="method-name">JobItemAddSimpleLineItem</span><span class="method-desc">Add a simple (non-IM) line item</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">json</td><td class="param-type">string (JSON)</td><td class="param-desc">JobItem model as JSON</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">JobItem</span> line = <span class="kw">new</span> <span class="tp">JobItem</span>();
line.JobNumber  = job.JOB_NO;
line.JobVersion = job.JOB_VERSION ?? <span class="num">0</span>;
line.DESCRIPTION = <span class="str">"something to charge 40 dollars"</span>;
line.UNIT_COST   = <span class="num">20</span>;
line.QUANTITY    = <span class="num">2</span>;

<span class="tp">string</span> result = <span class="fn">ConnectedShop.JobItemAddSimpleLineItem</span>(
    <span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(line)
);
<span class="cm">// Verify: job.TOTAL_COST == 40.0  (20 √ó 2)</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string (GUID)</span><span class="method-name">JobItemAddItemMasterItem</span><span class="method-desc">Add an Item Master line to a job</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">json</td><td class="param-type">string (JSON)</td><td class="param-desc">JobItem model with PARTCODE set</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">JobItem</span> line = <span class="kw">new</span> <span class="tp">JobItem</span>();
line.JobNumber  = job.JOB_NO;
line.JobVersion = job.JOB_VERSION ?? <span class="num">0</span>;
line.PARTCODE   = prod.PART_CODE;  <span class="cm">// "testprofile"</span>

<span class="tp">string</span> result = <span class="fn">ConnectedShop.JobItemAddItemMasterItem</span>(
    <span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(line)
);
<span class="cm">// Success: result contains "successfully"</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string (GUID)</span><span class="method-name">JobItemAddAssemblyInJob</span><span class="method-desc">Add a BOM assembly to a job</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">json</td><td class="param-type">string (JSON)</td><td class="param-desc">JobItem model with PARTCODE referencing assembly</td></tr>
          <tr><td class="param-name">SplitAsmQuantity</td><td class="param-type">int</td><td class="param-desc">Number of sub-assemblies to split into (0 = no split)</td></tr>
          <tr><td class="param-name">jsonPartInStock</td><td class="param-type">string (JSON)</td><td class="param-desc">Parts already in stock to exclude (empty = none)</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">JobItem</span> jobItem = <span class="kw">new</span> <span class="tp">JobItem</span>();
jobItem.PARTCODE   = <span class="str">"testprofile"</span>;
jobItem.JobNumber  = lastJob.JOB_NO;
jobItem.REVISION   = (lastJob.JOB_VERSION ?? <span class="num">1</span>).ToString();
jobItem.QUANTITY   = <span class="num">2</span>;

<span class="tp">string</span> jobItemJson = <span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(jobItem);
<span class="fn">ConnectedShopAPI.ConnectedShop.JobItemAddAssemblyInJob</span>(jobItemJson);

<span class="cm">// Verify:
//   job line with PARTCODE == "testprofile" and QUANTITY == 2 exists
//   assembly has 3 BOM nodes (triplet: parent + WO + leaf)</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">JobItemAddPartToJob</span><span class="method-desc">Add a SN/Tube/CTL part to a job</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">json</td><td class="param-type">string (JSON)</td><td class="param-desc">SXIPartInfo model as JSON</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">SXIPartInfo</span> part = <span class="kw">new</span> <span class="tp">SXIPartInfo</span>();
part.PartName    = <span class="str">"sampleparttoaddinjob"</span>;
part.JobName     = <span class="str">"job-24"</span>;
part.JobRevision = <span class="num">1</span>;
part.MachineName = <span class="str">"Laser"</span>;
part.Material    = <span class="str">"MS"</span>;
part.DueDate     = <span class="tp">DateTime</span>.<span class="fn">Parse</span>(<span class="str">"2025-09-23 14:55:54"</span>);
part.QtyToNest   = <span class="num">5</span>;
part.Area        = <span class="num">48.42</span>;
part.CuttingTime = <span class="num">137.74</span>;
part.Grain       = <span class="kw">false</span>;
part.GrossWeight = <span class="num">19.17</span>;
part.Machine     = <span class="num">2</span>;
part.CostFactor  = <span class="num">1.00</span>;
part.EnablePartTracking = <span class="kw">true</span>;
part.Priority    = <span class="num">10</span>;

<span class="tp">string</span> result = <span class="fn">ConnectedShop.JobItemAddPartToJob</span>(
    <span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(part)
);
<span class="cm">// Verify: job-24 has item with PARTCODE == "sampleparttoaddinjob"</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">JobItemUpdate</span><span class="method-desc">Update an existing job line item</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">json</td><td class="param-type">string (JSON)</td><td class="param-desc">Serialized job item with PK_JOB_ITEMS set</td></tr>
        </table>
        <div class="code-label">Unit Test Example ‚Äî Change quantity from 5 to 20</div>
        <div class="code-block"><span class="cm">// pkJob: 32CA8F76-1449-43C9-BEAE-04412AB67909</span>
<span class="kw">var</span> jobItems = jobItemsRepo.<span class="fn">Get</span>()
    .<span class="fn">Where</span>(x => x.FK_JOB == pkJob && x.ITEM_TYPE != <span class="num">7</span>).<span class="fn">ToList</span>();

<span class="kw">foreach</span> (<span class="kw">var</span> item <span class="kw">in</span> jobItems)
{
    <span class="kw">var</span> dict = <span class="tp">JsonConvert</span>.<span class="fn">DeserializeObject</span>&lt;<span class="tp">Dictionary</span>&lt;<span class="kw">string</span>, <span class="kw">object</span>&gt;&gt;(
                  <span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(item));
    <span class="kw">var</span> clean = dict.<span class="fn">Where</span>(kvp => kvp.Value != <span class="kw">null</span>)
                    .<span class="fn">ToDictionary</span>(k => k.Key, v => v.Value);
    clean[<span class="str">"QUANTITY"</span>] = <span class="num">20</span>;  <span class="cm">// change qty 5 ‚Üí 20</span>

    <span class="fn">ConnectedShop.JobItemUpdate</span>(<span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(clean));
}
<span class="cm">// Verify: item.QUANTITY * unitCost == 20 * 10 = 200</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string (GUID)</span><span class="method-name">JobItemCopyJobItemToBOM</span><span class="method-desc">Copy job item to an assembly library</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">pkBOMGroup</td><td class="param-type">string</td><td class="param-desc">Target BOM group GUID</td></tr>
          <tr><td class="param-name">jobPK</td><td class="param-type">string</td><td class="param-desc">Source job item GUID</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// line = job item with PARTCODE == "testprofile" and QUANTITY == 2
// group = BOM group "My Items"</span>
<span class="tp">string</span> res = <span class="fn">ConnectedShop.JobItemCopyJobItemToBOM</span>(
    group.PK_BOM_GROUP.ToString(),
    line.PK_JOB_ITEMS.ToString()
);
<span class="cm">// Verify: assembly "testprofile" created in library with 3 BOM nodes</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string (GUID)</span><span class="method-name">JobItemCopyJobItemToJob</span><span class="method-desc">Copy line item to another job</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">pkJobItem</td><td class="param-type">string</td><td class="param-desc">Source job item GUID</td></tr>
          <tr><td class="param-name">pkJob</td><td class="param-type">string</td><td class="param-desc">Target job GUID</td></tr>
          <tr><td class="param-name">qty</td><td class="param-type">decimal</td><td class="param-desc">Quantity to copy</td></tr>
          <tr><td class="param-name">requiredby</td><td class="param-type">DateTime</td><td class="param-desc">Required-by date for the new item</td></tr>
          <tr><td class="param-name">isRelease</td><td class="param-type">bool</td><td class="param-desc">Release the item immediately</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// line = first job item with PARTCODE == "testprofile"
// job  = newly created target job</span>
<span class="tp">string</span> result = <span class="fn">ConnectedShop.JobItemCopyJobItemToJob</span>(
    line.PK_JOB_ITEMS.ToString(),
    job.PK_JOBS.ToString(),
    <span class="num">2</span>,               <span class="cm">// quantity</span>
    <span class="tp">DateTime</span>.Now,
    <span class="kw">false</span>            <span class="cm">// isRelease</span>
);
<span class="tp">Guid</span> newItemId;
<span class="kw">if</span> (<span class="tp">Guid</span>.<span class="fn">TryParse</span>(result, <span class="kw">out</span> newItemId))
    <span class="kw">var</span> newLine = lineRep.<span class="fn">Get</span>(newItemId); <span class="cm">// should not be null</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string (GUID)</span><span class="method-name">JobItemCreateOperationForPart</span><span class="method-desc">Create operation on a WO BOM node</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">json</td><td class="param-type">string (JSON)</td><td class="param-desc">SXIPartInfo with MachineName, CuttingTime, ObjectType, etc.</td></tr>
          <tr><td class="param-name">woBomJob</td><td class="param-type">string</td><td class="param-desc">WO BOM node GUID (BOM_TYPE == 4)</td></tr>
          <tr><td class="param-name">orderID</td><td class="param-type">int</td><td class="param-desc">Operation order position</td></tr>
          <tr><td class="param-name">typeApp</td><td class="param-type">int</td><td class="param-desc"><code>0</code>=SigmaNEST ¬∑ <code>6</code>=CTL/Tube</td></tr>
          <tr><td class="param-name">UseCostFile</td><td class="param-type">string</td><td class="param-desc">Cost file name (empty = default)</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// part line = "testprofile", woBom = BOM_TYPE==4 node</span>
<span class="tp">SXIPartInfo</span> part = <span class="kw">new</span> <span class="tp">SXIPartInfo</span>();
part.MachineName  = <span class="str">"Bend"</span>;
part.CuttingTime  = <span class="num">5</span>;
part.ObjectType   = <span class="num">6</span>;   <span class="cm">// CTL/Tube</span>
part.ProcessCost  = <span class="num">11</span>;
part.CostFactor   = <span class="num">1</span>;

<span class="tp">string</span> result = <span class="fn">ConnectedShop.JobItemCreateOperationForPart</span>(
    <span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(part),
    woBom.PK_BOM_JOB.ToString(),
    <span class="num">0</span>,    <span class="cm">// orderID</span>
    <span class="num">0</span>,    <span class="cm">// typeApp: SigmaNEST</span>
    <span class="str">""</span>    <span class="cm">// UseCostFile</span>
);
<span class="cm">// Returns GUID of created CBOJ operation
// Verify: cboj.LABOUR_TIME >= 0.07</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">JobItemAddBomJobOperationsFromTemplate</span><span class="method-desc">Add operations from a named template</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">templateName</td><td class="param-type">string</td><td class="param-desc">Operations template name</td></tr>
          <tr><td class="param-name">woBom</td><td class="param-type">string</td><td class="param-desc">WO BOM node GUID</td></tr>
          <tr><td class="param-name">childBom</td><td class="param-type">string</td><td class="param-desc">Child BOM node GUID</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">string</span> templateName = <span class="str">"TestTemplate"</span>;
<span class="tp">string</span> woBom   = <span class="kw">new</span> <span class="tp">Guid</span>(<span class="str">"861DBE2B-A8E6-47AC-8B72-B4CC1F8B0820"</span>).ToString();
<span class="tp">string</span> childBom = <span class="kw">new</span> <span class="tp">Guid</span>(<span class="str">"0329ED62-2573-4DE7-A38D-AD7C1FFDE672"</span>).ToString();

<span class="tp">string</span> result = <span class="fn">ConnectedShop.JobItemAddBomJobOperationsFromTemplate</span>(
    templateName, woBom, childBom
);
<span class="cm">// Verify: all LABOUR_DESCRIPTION values from template exist in CBOJ table</span></div>
      </div>
    </div>

  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PURCHASE ORDERS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="po">
  <h2 class="section-title"><span class="section-icon">üõí</span>Purchase Orders (PO)</h2>
  <p>Full purchase order lifecycle ‚Äî creation, status changes, GRN creation, and dispatch.</p>
  <div class="method-grid">

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">POAddUpdatePO</span><span class="method-desc">Create or update a purchase order</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">json</td><td class="param-type">string (JSON)</td><td class="param-desc">PurchaseOrder model as JSON</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// First create the supplier company/contact</span>
<span class="tp">CustomerAndContactDataModel</span> supplier = <span class="kw">new</span> <span class="tp">CustomerAndContactDataModel</span>();
supplier.CompanyName            = <span class="str">"Main Supplies Company"</span>;
supplier.ContactName            = <span class="str">"Antonio Vovchenko"</span>;
supplier.Address1               = <span class="str">"123 Bad Street"</span>;
supplier.CompanyType            = <span class="num">2</span>;
supplier.CompanyTypeDescription = <span class="str">"Supplier"</span>;
supplier.TaxRate                = <span class="str">"20"</span>;
<span class="fn">ConnectedShop.ContactAddCompanyAndContact</span>(<span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(supplier));

<span class="cm">// Then create the PO</span>
<span class="tp">PurchaseOrder</span> po = <span class="kw">new</span> <span class="tp">PurchaseOrder</span>();
po.FK_SUPPLIER = comp.PK_COMPANY;  <span class="cm">// "Main Supplies Company"</span>
po.FK_CONTACT  = cont.PK_CONTACT;  <span class="cm">// "Antonio Vovchenko"</span>
po.ESTIMATOR   = <span class="str">"Subhan"</span>;

<span class="tp">string</span> msg = <span class="fn">ConnectedShopAPI.ConnectedShop.POAddUpdatePO</span>(
    <span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(po)
);
<span class="cm">// Success: msg contains "successfully"</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">POStatusChange</span><span class="method-desc">Change PO status</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">pkPO</td><td class="param-type">string</td><td class="param-desc">PO GUID</td></tr>
          <tr><td class="param-name">status</td><td class="param-type">string</td><td class="param-desc">Target status: "Draft", "Sent Out", "Part Received", "Received", "Cancelled"</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">string</span> msg = <span class="fn">ConnectedShopAPI.ConnectedShop.POStatusChange</span>(
    poOne.PK_PO.ToString(),
    <span class="str">"Sent Out"</span>
);
<span class="cm">// Success: msg == "" (empty string)</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string (GUID)</span><span class="method-name">POCopyPO</span><span class="method-desc">Copy a purchase order</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">pk</td><td class="param-type">string</td><td class="param-desc">Source PO GUID</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">string</span> msg = <span class="fn">ConnectedShopAPI.ConnectedShop.POCopyPO</span>(
    poOne.PK_PO.ToString()
);
<span class="tp">Guid</span> g;
<span class="kw">if</span> (<span class="tp">Guid</span>.<span class="fn">TryParse</span>(msg, <span class="kw">out</span> g))
{
    <span class="kw">var</span> lines = itemsRep.<span class="fn">Get</span>().<span class="fn">Where</span>(x => x.FK_PO == g).<span class="fn">ToList</span>();
    <span class="cm">// Verify: lines[0].DESCRIPTION == "testprofile"</span>
}</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string (GUID)</span><span class="method-name">PORevisionPO</span><span class="method-desc">Create a PO revision</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">pk</td><td class="param-type">string</td><td class="param-desc">Source PO GUID</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">string</span> msg = <span class="fn">ConnectedShopAPI.ConnectedShop.PORevisionPO</span>(
    poOne.PK_PO.ToString()
);
<span class="tp">Guid</span> g;
<span class="kw">if</span> (<span class="tp">Guid</span>.<span class="fn">TryParse</span>(msg, <span class="kw">out</span> g))
{
    <span class="kw">var</span> revisedPO = poRep.<span class="fn">Get</span>(g);
    <span class="cm">// Verify: revisedPO.PO_VERSION == 2</span>
    <span class="cm">// Verify: line items are copied ("testprofile")</span>
}</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">POAddPOItemsSmartFromJob</span><span class="method-desc">Auto-add PO items from job BOMs</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">jobid</td><td class="param-type">string</td><td class="param-desc">Source job GUID</td></tr>
          <tr><td class="param-name">poid</td><td class="param-type">string</td><td class="param-desc">Target PO GUID</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// jobOne = job with JobNoInt == 4</span>
<span class="tp">string</span> msg = <span class="fn">ConnectedShopAPI.ConnectedShop.POAddPOItemsSmartFromJob</span>(
    jobOne.PK_JOBS.ToString(),
    poOne.PK_PO.ToString()
);
<span class="cm">// Success: msg is null or empty string</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string (GUID)</span><span class="method-name">POCreateGRN</span><span class="method-desc">Create GRN from a PO</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">pkPO</td><td class="param-type">string</td><td class="param-desc">PO GUID</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">string</span> msg = <span class="fn">ConnectedShopAPI.ConnectedShop.POCreateGRN</span>(
    poOne.PK_PO.ToString()
);
<span class="tp">Guid</span> grnGuid;
<span class="kw">if</span> (<span class="tp">Guid</span>.<span class="fn">TryParse</span>(msg, <span class="kw">out</span> grnGuid))
{
    <span class="kw">var</span> grn = grnRep.<span class="fn">Get</span>(grnGuid);
    <span class="kw">var</span> items = itemsRep.<span class="fn">Get</span>().<span class="fn">Where</span>(x => x.FK_DOCUMENT_HEADER == grnGuid).<span class="fn">ToList</span>();
    <span class="cm">// Verify: items.Count == 2</span>
}</div>
      </div>
    </div>

  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PO ITEMS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="po-item">
  <h2 class="section-title"><span class="section-icon">üìå</span>PO Items</h2>
  <div class="method-grid">
    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">POAddUpdatePOItem</span><span class="method-desc">Add or update a PO line item</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">json</td><td class="param-type">string (JSON)</td><td class="param-desc">PurchaseOrderItem model as JSON</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// po = first available PO, prod = IM with PART_CODE "testprofile"</span>
<span class="kw">var</span> poItem = <span class="kw">new</span> <span class="tp">PurchaseOrderItem</span>();
poItem.FK_PO        = po.PK_PO;
poItem.FK_ITEM_TYPE = prod.PK_PRODUCT_ITEM;

<span class="tp">string</span> msg = <span class="fn">ConnectedShopAPI.ConnectedShop.POAddUpdatePOItem</span>(
    <span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(poItem)
);
<span class="cm">// Success: msg == "" (empty)
// Verify: created item has PARTCODE=="testprofile", TAX_RATE==20, SIZEX==5, SIZEY==10</span></div>
      </div>
    </div>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê NCR ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="ncr">
  <h2 class="section-title"><span class="section-icon">üö®</span>NCR ‚Äî Non-Conformance Reports</h2>
  <div class="method-grid">
    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">NCRAddUpdateNCR</span><span class="method-desc">Create or update an NCR</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">ncrModelData</td><td class="param-type">string (JSON)</td><td class="param-desc">NCR data model as JSON</td></tr>
        </table>
        <div class="code-block"><span class="tp">string</span> result = <span class="fn">ConnectedShop.NCRAddUpdateNCR</span>(
    <span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(ncrModel)
);</div>
      </div>
    </div>
    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">NCRAddUpdateComplaint</span><span class="method-desc">Create or update a complaint</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">complaintModelData</td><td class="param-type">string (JSON)</td><td class="param-desc">Complaint data model as JSON</td></tr>
        </table>
        <div class="code-block"><span class="tp">string</span> result = <span class="fn">ConnectedShop.NCRAddUpdateComplaint</span>(
    <span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(complaintModel)
);</div>
      </div>
    </div>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PLANNER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="planner">
  <h2 class="section-title"><span class="section-icon">üìÖ</span>Planner</h2>
  <p>Production planning, scheduling, and resource capacity management.</p>
  <div class="method-grid">

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-intptr">IntPtr</span><span class="method-name">PlannerPostPlanRequest</span><span class="method-desc">Submit a planning request for a job</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">jobID</td><td class="param-type">string</td><td class="param-desc">Job GUID</td></tr>
          <tr><td class="param-name">forUI</td><td class="param-type">bool</td><td class="param-desc">Request is from UI context</td></tr>
          <tr><td class="param-name">reqType</td><td class="param-type">string</td><td class="param-desc">Request type e.g. "ClearJob"</td></tr>
          <tr><td class="param-name">startDateTime</td><td class="param-type">double</td><td class="param-desc">Start date as OLE Automation date</td></tr>
          <tr><td class="param-name">endDateTime</td><td class="param-type">double</td><td class="param-desc">End date as OLE Automation date</td></tr>
          <tr><td class="param-name">orderingEntity</td><td class="param-type">string</td><td class="param-desc">Ordering entity GUID (empty = none)</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// jobID = GUID of job with JobNoInt == 26</span>
<span class="tp">IntPtr</span> output = <span class="fn">ConnectedShop.PlannerPostPlanRequest</span>(
    jobID,
    <span class="kw">true</span>,                            <span class="cm">// forUI</span>
    <span class="str">"ClearJob"</span>,                      <span class="cm">// reqType</span>
    <span class="tp">DateTime</span>.Now.<span class="fn">ToOADate</span>(),          <span class="cm">// startDateTime</span>
    <span class="tp">DateTime</span>.Now.<span class="fn">ToOADate</span>(),          <span class="cm">// endDateTime</span>
    <span class="str">""</span>                               <span class="cm">// orderingEntity</span>
);
<span class="tp">string</span> response = <span class="tp">Marshal</span>.<span class="fn">PtrToStringUni</span>(output);</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">PlannerIsPlannerRunning</span><span class="method-desc">Check if planner service is active</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <div class="code-block"><span class="kw">if</span> (<span class="fn">ConnectedShop.PlannerIsPlannerRunning</span>())
    <span class="fn">Console.WriteLine</span>(<span class="str">"Planner is active"</span>);</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-void">void</span><span class="method-name">PlannerClearScheduleForJob</span><span class="method-desc">Clear planning schedule for a job</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">jobID</td><td class="param-type">string</td><td class="param-desc">Job GUID</td></tr>
          <tr><td class="param-name">woID</td><td class="param-type">string</td><td class="param-desc">WO BOM node GUID filter</td></tr>
          <tr><td class="param-name">opID</td><td class="param-type">string</td><td class="param-desc">Operation GUID filter</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// job = JobNoInt 27, woBom = BOM_TYPE==4 node</span>
<span class="fn">ConnectedShop.PlannerClearScheduleForJob</span>(
    job.PK_JOBS.ToString(),
    woBom.PK_BOM_JOB.ToString(),
    jobOperations[<span class="num">0</span>].PK_BOM_OPERATIONS_JOB.ToString()
);
<span class="cm">// Verify: job.PLANNED_END_DATE == null</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-int">int</span><span class="method-name">PlannerGetAvailableMinutesForResource</span><span class="method-desc">Get available capacity for a resource</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">considerCapacity</td><td class="param-type">bool</td><td class="param-desc">Apply capacity rules</td></tr>
          <tr><td class="param-name">startDateTime</td><td class="param-type">DateTime</td><td class="param-desc">Range start</td></tr>
          <tr><td class="param-name">endDateTime</td><td class="param-type">DateTime</td><td class="param-desc">Range end</td></tr>
          <tr><td class="param-name">resourceID</td><td class="param-type">string</td><td class="param-desc">Resource GUID</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="kw">int</span> availableMinutes = <span class="fn">ConnectedShop.PlannerGetAvailableMinutesForResource</span>(
    <span class="kw">true</span>,
    <span class="tp">DateTime</span>.<span class="fn">Parse</span>(<span class="str">"2025-10-17 12:29:07.137"</span>),
    <span class="tp">DateTime</span>.<span class="fn">Parse</span>(<span class="str">"2025-10-17 16:29:07.137"</span>),
    <span class="str">"D7C0A8AE-986E-43B0-ADBD-B9FD73576E2C"</span>
);
<span class="cm">// Expected: 150 minutes available in 4-hour window</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-int">int</span><span class="method-name">PlannerGetActualMinutesForResource</span><span class="method-desc">Get actual booked minutes for a resource</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">startDateTime</td><td class="param-type">DateTime</td><td class="param-desc">Range start</td></tr>
          <tr><td class="param-name">endDateTime</td><td class="param-type">DateTime</td><td class="param-desc">Range end</td></tr>
          <tr><td class="param-name">resourceID</td><td class="param-type">string</td><td class="param-desc">Resource GUID</td></tr>
          <tr><td class="param-name">usePrograms</td><td class="param-type">bool</td><td class="param-desc">Include program-based bookings</td></tr>
          <tr><td class="param-name">considerArchives</td><td class="param-type">bool</td><td class="param-desc">Include archived records</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="kw">int</span> actualMinutes = <span class="fn">ConnectedShop.PlannerGetActualMinutesForResource</span>(
    <span class="tp">DateTime</span>.<span class="fn">Parse</span>(<span class="str">"2025-10-15 00:00:00"</span>),
    <span class="tp">DateTime</span>.<span class="fn">Parse</span>(<span class="str">"2025-10-17 00:00:00"</span>),
    <span class="str">"38B7A063-4BFB-4DB2-9E48-D1FBBA88F0E1"</span>,
    <span class="kw">false</span>,  <span class="cm">// usePrograms</span>
    <span class="kw">false</span>   <span class="cm">// considerArchives</span>
);
<span class="cm">// Expected: 33 minutes actually booked</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-void">void</span><span class="method-name">PlannerUpdateProgrammingStartTime</span><span class="method-desc">Sync operation start times to job start</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">aJobID</td><td class="param-type">string</td><td class="param-desc">Job number string (e.g. "job-27")</td></tr>
          <tr><td class="param-name">repeatID</td><td class="param-type">int</td><td class="param-desc">Repeat identifier</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="fn">ConnectedShop.PlannerUpdateProgrammingStartTime</span>(<span class="str">"job-27"</span>, <span class="num">1</span>);
<span class="cm">// Verify: all CBOJ operations for job-27 have
//   PROGRAMMING_STARTTIME == job.ORDER_START</span></div>
      </div>
    </div>

  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PROGRAM RECORDING ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="program-recording">
  <h2 class="section-title"><span class="section-icon">‚è∫Ô∏è</span>Program Recording</h2>
  <p>Manage program lifecycle recording for cutting operations.</p>
  <div class="info-box note"><div class="label">Note</div>Unit test stubs exist for these methods but are not yet implemented. The API calls are available and functional.</div>
  <div class="method-grid">

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">ProgramRecordingStartRecording</span><span class="method-desc">Start recording a program run</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">programName</td><td class="param-type">string</td><td class="param-desc">Program/nest file name</td></tr>
          <tr><td class="param-name">repeatID</td><td class="param-type">int</td><td class="param-desc">Repeat identifier</td></tr>
          <tr><td class="param-name">machineName</td><td class="param-type">string</td><td class="param-desc">Machine/workstation name</td></tr>
        </table>
        <div class="code-block"><span class="fn">ConnectedShop.ProgramRecordingStartRecording</span>(<span class="str">"PROG-001"</span>, <span class="num">1</span>, <span class="str">"Laser1"</span>);</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">ProgramRecordingStopRecording</span><span class="method-desc">Pause recording</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">programName</td><td class="param-type">string</td><td class="param-desc">Program name</td></tr>
          <tr><td class="param-name">repeatID</td><td class="param-type">int</td><td class="param-desc">Repeat identifier</td></tr>
        </table>
        <div class="code-block"><span class="fn">ConnectedShop.ProgramRecordingStopRecording</span>(<span class="str">"PROG-001"</span>, <span class="num">1</span>);</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">ProgramRecordingFinishRecording</span><span class="method-desc">Finish and commit recording</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">programName</td><td class="param-type">string</td><td class="param-desc">Program name</td></tr>
          <tr><td class="param-name">repeatID</td><td class="param-type">int</td><td class="param-desc">Repeat identifier</td></tr>
        </table>
        <div class="code-block"><span class="fn">ConnectedShop.ProgramRecordingFinishRecording</span>(<span class="str">"PROG-001"</span>, <span class="num">1</span>);</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">ProgramRecordingResetRecording</span><span class="method-desc">Reset / discard a recording</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">programName</td><td class="param-type">string</td><td class="param-desc">Program name</td></tr>
          <tr><td class="param-name">repeatID</td><td class="param-type">int</td><td class="param-desc">Repeat identifier</td></tr>
        </table>
        <div class="code-block"><span class="fn">ConnectedShop.ProgramRecordingResetRecording</span>(<span class="str">"PROG-001"</span>, <span class="num">1</span>);</div>
      </div>
    </div>

  </div>
  <div class="code-label" style="margin-top:1rem">Typical Workflow</div>
  <div class="code-block"><span class="cm">// 1. Machine starts cutting</span>
<span class="fn">ConnectedShop.ProgramRecordingStartRecording</span>(<span class="str">"PROG-001"</span>, <span class="num">1</span>, <span class="str">"Laser1"</span>);

<span class="cm">// 2. Optional pause mid-run</span>
<span class="fn">ConnectedShop.ProgramRecordingStopRecording</span>(<span class="str">"PROG-001"</span>, <span class="num">1</span>);

<span class="cm">// 3. Cutting complete ‚Äî commits time + qty data</span>
<span class="fn">ConnectedShop.ProgramRecordingFinishRecording</span>(<span class="str">"PROG-001"</span>, <span class="num">1</span>);

<span class="cm">// OR: discard everything</span>
<span class="fn">ConnectedShop.ProgramRecordingResetRecording</span>(<span class="str">"PROG-001"</span>, <span class="num">1</span>);</div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê REPORTS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="reports">
  <h2 class="section-title"><span class="section-icon">üìä</span>Reports</h2>
  <p>Generate PDF, image, or HTML reports from document records.</p>
  <div class="method-grid">
    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-void">void</span><span class="method-name">ReportsCreateReportPDF</span><span class="method-desc">Generate report in PDF, IMAGE, or HTML format</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">reportPK</td><td class="param-type">string</td><td class="param-desc">Document number or <code>{GUID}</code> for job/PO based reports</td></tr>
          <tr><td class="param-name">reportFullName</td><td class="param-type">string</td><td class="param-desc">Full path to the .rtm report template</td></tr>
          <tr><td class="param-name">outputPath</td><td class="param-type">string</td><td class="param-desc">Output directory path</td></tr>
          <tr><td class="param-name">reportType</td><td class="param-type">string</td><td class="param-desc"><code>"PDF"</code> ¬∑ <code>"IMAGE"</code> ¬∑ <code>"HTML"</code></td></tr>
        </table>
        <div class="code-label">Unit Test Examples</div>
        <div class="code-block"><span class="tp">string</span> outputPath = <span class="str">@"C:\CSAPICreateReportFunctionTestCaseFilesDump\"</span>;

<span class="cm">// Delivery Note (document number as key)</span>
<span class="fn">ConnectedShop.ReportsCreateReportPDF</span>(
    <span class="str">"DEL-2"</span>,
    <span class="str">@"C:\Users\Public\Documents\SigmaMRP\Reports\en\Documents\Delivery Note.rtm"</span>,
    outputPath, <span class="str">"PDF"</span>
);
<span class="cm">// Creates: C:\...\DEL-2.pdf</span>

<span class="cm">// Invoice</span>
<span class="fn">ConnectedShop.ReportsCreateReportPDF</span>(
    <span class="str">"INV-1"</span>,
    <span class="str">@"C:\Users\Public\Documents\SigmaMRP\Reports\en\Documents\Invoice.rtm"</span>,
    outputPath, <span class="str">"IMAGE"</span>
);

<span class="cm">// GRN</span>
<span class="fn">ConnectedShop.ReportsCreateReportPDF</span>(
    <span class="str">"GRN-1"</span>,
    <span class="str">@"C:\Users\Public\Documents\SigmaMRP\Reports\en\Documents\Goods Received.rtm"</span>,
    outputPath, <span class="str">"HTML"</span>
);

<span class="cm">// Job-based report ‚Äî wrap GUID in curly braces</span>
<span class="tp">Guid</span> pkJob = jobsRepo.<span class="fn">Get</span>().<span class="fn">Where</span>(x => x.JobNoInt == <span class="num">28</span>).<span class="fn">Select</span>(x => x.PK_JOBS).<span class="fn">First</span>();
<span class="tp">string</span> fileName = <span class="str">"{"</span> + pkJob.ToString().ToUpper() + <span class="str">"}"</span>;
<span class="fn">ConnectedShop.ReportsCreateReportPDF</span>(
    fileName,
    <span class="str">@"C:\Users\Public\Documents\SigmaMRP\Reports\en\Documents\Draft Quotation.rtm"</span>,
    outputPath, <span class="str">"PDF"</span>
);

<span class="cm">// PO-based report</span>
<span class="tp">Guid</span> pkPo = poDbRepo.<span class="fn">Get</span>().<span class="fn">Where</span>(x => x.ORDER_NO == <span class="str">"PO-2"</span>).<span class="fn">Select</span>(x => x.PK_PO).<span class="fn">First</span>();
<span class="fn">ConnectedShop.ReportsCreateReportPDF</span>(
    <span class="str">"{"</span> + pkPo.ToString().ToUpper() + <span class="str">"}"</span>,
    <span class="str">@"C:\Users\Public\Documents\SigmaMRP\Reports\en\Documents\Purchase Order.rtm"</span>,
    outputPath, <span class="str">"PDF"</span>
);

<span class="cm">// Batch book-in report (GIN)</span>
<span class="fn">ConnectedShop.ReportsCreateReportPDF</span>(
    <span class="str">"BCH-11"</span>,
    <span class="str">@"C:\Users\Public\Documents\SigmaMRP\Reports\en\Documents\GIN.rtm"</span>,
    outputPath, <span class="str">"PDF"</span>
);</div>
      </div>
    </div>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SIGMANEST ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="sigmanest">
  <h2 class="section-title"><span class="section-icon">‚úÇÔ∏è</span>SigmaNEST</h2>
  <p>Integration with SigmaNEST cutting optimization ‚Äî program updates, part tracking, and rejections.</p>
  <div class="method-grid">

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">SigmanestUpdateProgram</span><span class="method-desc">Update a single SigmaNEST program</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">programName</td><td class="param-type">string</td><td class="param-desc">SigmaNEST program name</td></tr>
          <tr><td class="param-name">repeatID</td><td class="param-type">int</td><td class="param-desc">Repeat identifier</td></tr>
          <tr><td class="param-name">operatorName</td><td class="param-type">string</td><td class="param-desc">Operator who ran the program</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// progDetails = program "program_sigmanestUpdateProgram"</span>
<span class="tp">bool</span> output = <span class="fn">ConnectedShop.SigmanestUpdateProgram</span>(
    progDetails.ProgramName,
    progDetails.RepeatID,
    <span class="str">""</span>  <span class="cm">// operatorName</span>
);
<span class="cm">// Verify on success:
//   Program removed from PROGRAM table
//   ProgArchive row exists with TransType == "SN102" and RepeatID == 1</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">SigmanestUpdateMultiplePrograms</span><span class="method-desc">Update multiple programs in batch</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">programs</td><td class="param-type">string (JSON)</td><td class="param-desc">JSON array of SnProgramModel objects</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="cm">// programs = all PROGRAM table rows with ProgramName == "10"</span>
<span class="tp">List</span>&lt;<span class="tp">SnProgramModel</span>&gt; programList = <span class="kw">new</span> <span class="tp">List</span>&lt;<span class="tp">SnProgramModel</span>&gt;();
<span class="kw">foreach</span> (<span class="kw">var</span> program <span class="kw">in</span> programs)
{
    programList.<span class="fn">Add</span>(<span class="kw">new</span> <span class="tp">SnProgramModel</span>
    {
        ProgramName  = program.ProgramName,
        RepeatID     = program.RepeatID,
        OperatorName = program.OperatorName
    });
}
<span class="tp">string</span> json = <span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(programList);

<span class="tp">bool</span> output = <span class="fn">ConnectedShop.SigmanestUpdateMultiplePrograms</span>(json);
<span class="cm">// Verify: both RepeatID==1 and RepeatID==2 archived with TransType "SN102"</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">SigmanestChangePartInProcessQuantity</span><span class="method-desc">Update part in-process quantity</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">programName</td><td class="param-type">string</td><td class="param-desc">Program name</td></tr>
          <tr><td class="param-name">repeatID</td><td class="param-type">int</td><td class="param-desc">Repeat identifier</td></tr>
          <tr><td class="param-name">woNumber</td><td class="param-type">string</td><td class="param-desc">Work order number</td></tr>
          <tr><td class="param-name">partName</td><td class="param-type">string</td><td class="param-desc">Part name</td></tr>
          <tr><td class="param-name">quantity</td><td class="param-type">int</td><td class="param-desc">New in-process quantity</td></tr>
        </table>
        <div class="code-block"><span class="tp">bool</span> ok = <span class="fn">ConnectedShop.SigmanestChangePartInProcessQuantity</span>(
    <span class="str">"PROG-001"</span>, <span class="num">1</span>, <span class="str">"WO-100"</span>, <span class="str">"PartA"</span>, <span class="num">5</span>
);</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">SigmanestAddPipRejected</span><span class="method-desc">Record rejected parts</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">programName</td><td class="param-type">string</td><td class="param-desc">Program name</td></tr>
          <tr><td class="param-name">repeatID</td><td class="param-type">int</td><td class="param-desc">Repeat identifier</td></tr>
          <tr><td class="param-name">woNumber</td><td class="param-type">string</td><td class="param-desc">Work order number</td></tr>
          <tr><td class="param-name">partName</td><td class="param-type">string</td><td class="param-desc">Part name</td></tr>
          <tr><td class="param-name">quantity</td><td class="param-type">int</td><td class="param-desc">Rejected quantity</td></tr>
          <tr><td class="param-name">rejectReasonId</td><td class="param-type">int</td><td class="param-desc">Rejection reason code</td></tr>
          <tr><td class="param-name">comment</td><td class="param-type">string</td><td class="param-desc">Additional comment</td></tr>
          <tr><td class="param-name">operatorName</td><td class="param-type">string</td><td class="param-desc">Operator name</td></tr>
          <tr><td class="param-name">scrapped</td><td class="param-type">string</td><td class="param-desc">"Y" or "N"</td></tr>
          <tr><td class="param-name">sheetName</td><td class="param-type">string</td><td class="param-desc">Sheet/plate name</td></tr>
        </table>
        <div class="code-block"><span class="tp">bool</span> ok = <span class="fn">ConnectedShop.SigmanestAddPipRejected</span>(
    <span class="str">"PROG-001"</span>, <span class="num">1</span>, <span class="str">"WO-100"</span>, <span class="str">"PartA"</span>,
    <span class="num">2</span>,     <span class="cm">// quantity</span>
    <span class="num">3</span>,     <span class="cm">// rejectReasonId</span>
    <span class="str">"Dimensional error"</span>,
    <span class="str">"Operator1"</span>,
    <span class="str">"Y"</span>,   <span class="cm">// scrapped</span>
    <span class="str">"Sheet1"</span>
);</div>
      </div>
    </div>

  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê STOCKS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="stocks">
  <h2 class="section-title"><span class="section-icon">üóÑÔ∏è</span>Stocks</h2>
  <p>Sheet and raw material stock management.</p>
  <div class="method-grid">

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-int">int</span><span class="method-name">StocksAddModifyStock3Plus</span><span class="method-desc">Add or modify sheet stock</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">sheetName</td><td class="param-type">string</td><td class="param-desc">Sheet identifier name</td></tr>
          <tr><td class="param-name">modifiedSheetName</td><td class="param-type">string</td><td class="param-desc">New name if renaming (empty = no rename)</td></tr>
          <tr><td class="param-name">customer</td><td class="param-type">string</td><td class="param-desc">Customer name</td></tr>
          <tr><td class="param-name">sheetUniqueID</td><td class="param-type">string</td><td class="param-desc">Unique ID (empty = auto-generate)</td></tr>
          <tr><td class="param-name">material</td><td class="param-type">string</td><td class="param-desc">Material type e.g. "MS"</td></tr>
          <tr><td class="param-name">location</td><td class="param-type">string</td><td class="param-desc">Warehouse location</td></tr>
          <tr><td class="param-name">heatNumber</td><td class="param-type">string</td><td class="param-desc">Heat/mill number</td></tr>
          <tr><td class="param-name">thickness</td><td class="param-type">double</td><td class="param-desc">Sheet thickness</td></tr>
          <tr><td class="param-name">length</td><td class="param-type">double</td><td class="param-desc">Sheet length (X)</td></tr>
          <tr><td class="param-name">width</td><td class="param-type">double</td><td class="param-desc">Sheet width (Y)</td></tr>
          <tr><td class="param-name">area</td><td class="param-type">double</td><td class="param-desc">Sheet area</td></tr>
          <tr><td class="param-name">cost</td><td class="param-type">double</td><td class="param-desc">Unit cost</td></tr>
          <tr><td class="param-name">quantity</td><td class="param-type">int</td><td class="param-desc">Quantity of sheets</td></tr>
          <tr><td class="param-name">sheetType</td><td class="param-type">int</td><td class="param-desc">Sheet type code</td></tr>
          <tr><td class="param-name">remark</td><td class="param-type">string</td><td class="param-desc">Remark/notes</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="fn">ConnectedShopAPI.ConnectedShop.StocksAddModifyStock3Plus</span>(
    <span class="str">"Sheet1"</span>,    <span class="cm">// sheetName</span>
    <span class="str">""</span>,          <span class="cm">// modifiedSheetName</span>
    <span class="str">""</span>,          <span class="cm">// customer</span>
    <span class="str">""</span>,          <span class="cm">// sheetUniqueID</span>
    <span class="str">"MS"</span>,        <span class="cm">// material</span>
    <span class="str">""</span>,          <span class="cm">// location</span>
    <span class="str">"12345"</span>,     <span class="cm">// heatNumber</span>
    <span class="str">""</span>, <span class="str">""</span>, <span class="str">""</span>,  <span class="cm">// binNumber, mill, primeCode</span>
    <span class="num">1</span>,           <span class="cm">// thickness</span>
    <span class="num">200</span>,         <span class="cm">// length</span>
    <span class="num">100</span>,         <span class="cm">// width</span>
    <span class="num">20000</span>,       <span class="cm">// area</span>
    <span class="num">70</span>,          <span class="cm">// cost</span>
    <span class="num">10</span>,          <span class="cm">// quantity</span>
    <span class="num">0</span>,           <span class="cm">// sheetType</span>
    <span class="str">"my favorite sheet"</span>,
    <span class="num">0</span>, <span class="num">0</span>,        <span class="cm">// specialProperties1, 2</span>
    <span class="str">""</span>,          <span class="cm">// specialInstruction</span>
    <span class="num">0</span>,           <span class="cm">// actionType</span>
    <span class="str">""</span>,          <span class="cm">// sheetData</span>
    <span class="num">0</span>, <span class="num">0</span>, <span class="num">0</span>, <span class="num">0</span>, <span class="cm">// edge distances</span>
    <span class="num">0</span>, <span class="num">0</span>,        <span class="cm">// actualSheetPrice, actualWeight</span>
    <span class="kw">false</span>,       <span class="cm">// deleteSheetWithZeroOrNegativeQty</span>
    <span class="kw">false</span>        <span class="cm">// deleteInProcess</span>
);
<span class="cm">// Verify: stock "Sheet1" exists in StockDb table</span></div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-int">int</span><span class="method-name">StocksDeleteStock</span><span class="method-desc">Delete a stock sheet</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">evenIfInProcess</td><td class="param-type">bool</td><td class="param-desc">Delete even if sheet is in-process</td></tr>
          <tr><td class="param-name">sheetName</td><td class="param-type">string</td><td class="param-desc">Sheet name to delete</td></tr>
        </table>
        <div class="code-block"><span class="kw">int</span> result = <span class="fn">ConnectedShop.StocksDeleteStock</span>(<span class="kw">false</span>, <span class="str">"Sheet1"</span>);</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">StocksReplaceSheetInProcess</span><span class="method-desc">Swap an in-process sheet</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">programName</td><td class="param-type">string</td><td class="param-desc">Program name</td></tr>
          <tr><td class="param-name">repeatId</td><td class="param-type">int</td><td class="param-desc">Repeat identifier</td></tr>
          <tr><td class="param-name">newSheetName</td><td class="param-type">string</td><td class="param-desc">Replacement sheet name</td></tr>
          <tr><td class="param-name">orgSheetName</td><td class="param-type">string</td><td class="param-desc">Original sheet being replaced</td></tr>
          <tr><td class="param-name">appName</td><td class="param-type">string</td><td class="param-desc">Calling application name</td></tr>
          <tr><td class="param-name">funcDesc</td><td class="param-type">string</td><td class="param-desc">Function description for audit</td></tr>
        </table>
        <div class="code-block"><span class="tp">bool</span> ok = <span class="fn">ConnectedShop.StocksReplaceSheetInProcess</span>(
    <span class="str">"PROG-001"</span>, <span class="num">1</span>, <span class="str">"Sheet2"</span>, <span class="str">"Sheet1"</span>, <span class="str">"MyApp"</span>, <span class="str">"SwapSheet"</span>
);</div>
      </div>
    </div>

  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PLT ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="plt">
  <h2 class="section-title"><span class="section-icon">üìç</span>Production Location Tracking (PLT)</h2>
  <p>Track part movements through production locations and validate quantities.</p>
  <h3 class="sub-title">Error Codes</h3>
  <table class="error-table">
    <tr><th>Code</th><th>Constant</th><th>Description</th></tr>
    <tr><td class="code-val">0</td><td><code>QandL_FAILURECODE_0</code></td><td class="pass-val">Pass ‚Äî validation OK</td></tr>
    <tr><td class="code-val">1</td><td><code>QandL_FAILURECODE_1</code></td><td class="fail-val">Quantity mismatch</td></tr>
    <tr><td class="code-val">3</td><td><code>QandL_FAILURECODE_3</code></td><td class="fail-val">Location does not exist</td></tr>
    <tr><td class="code-val">4</td><td><code>QandL_FAILURECODE_4</code></td><td class="fail-val">All items must be assigned to a location</td></tr>
    <tr><td class="code-val">5</td><td><code>QandL_FAILURECODE_5</code></td><td class="fail-val">Insufficient picked quantity</td></tr>
    <tr><td class="code-val">6</td><td><code>QandL_FAILURECODE_6</code></td><td class="fail-val">Inconsistent item assignment</td></tr>
  </table>
  <div class="method-grid" style="margin-top:1rem">

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string (error code)</span><span class="method-name">PerformQtyAndLocationCheck</span><span class="method-desc">Validate PLT move quantities and locations</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">selWSId</td><td class="param-type">string</td><td class="param-desc">Selected workstation GUID</td></tr>
          <tr><td class="param-name">jsonPLTCbojList</td><td class="param-type">string (JSON)</td><td class="param-desc">List of PLT CBOJ items to validate</td></tr>
          <tr><td class="param-name">callReason</td><td class="param-type">string</td><td class="param-desc">Reason for the check (for audit)</td></tr>
        </table>
        <div class="code-block"><span class="tp">string</span> errorCode = <span class="fn">ConnectedShop.PerformQtyAndLocationCheck</span>(
    workstation.PK_WORKSTATION.ToString(),
    <span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(pltItems),
    <span class="str">"PreDispatch"</span>
);
<span class="kw">if</span> (errorCode == <span class="str">"0"</span>)
    <span class="fn">Console.WriteLine</span>(<span class="str">"Validation passed"</span>);</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">ExecuteMove</span><span class="method-desc">Execute a batch of PLT movements</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">movesData</td><td class="param-type">string (JSON)</td><td class="param-desc">ProductionLocationMovementModel as JSON</td></tr>
        </table>
        <div class="code-label">Movement Model JSON</div>
        <div class="code-block">{
  <span class="str">"UserId"</span>: <span class="str">"user-guid"</span>,
  <span class="str">"Source"</span>: <span class="str">"MyApp"</span>,
  <span class="str">"MoveType"</span>: <span class="str">"Standard"</span>,
  <span class="str">"Moves"</span>: [
    {
      <span class="str">"CbojId"</span>: <span class="str">"cboj-guid"</span>,
      <span class="str">"WhsFrom"</span>: <span class="str">"from-location-guid"</span>,
      <span class="str">"WhsTo"</span>: <span class="str">"to-location-guid"</span>,
      <span class="str">"Qty"</span>: <span class="num">5</span>
    }
  ]
}

<span class="tp">string</span> result = <span class="fn">ConnectedShop.ExecuteMove</span>(
    <span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(movementModel)
);</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">ExecuteSingleMove</span><span class="method-desc">Execute one PLT movement</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">transaction</td><td class="param-type">string</td><td class="param-desc">Transaction identifier</td></tr>
          <tr><td class="param-name">cboj</td><td class="param-type">string</td><td class="param-desc">CBOJ GUID</td></tr>
          <tr><td class="param-name">whsFrom</td><td class="param-type">string</td><td class="param-desc">Source warehouse GUID</td></tr>
          <tr><td class="param-name">whsTo</td><td class="param-type">string</td><td class="param-desc">Destination warehouse GUID</td></tr>
          <tr><td class="param-name">qty</td><td class="param-type">double</td><td class="param-desc">Quantity to move</td></tr>
          <tr><td class="param-name">userid</td><td class="param-type">string</td><td class="param-desc">User GUID</td></tr>
          <tr><td class="param-name">source</td><td class="param-type">string</td><td class="param-desc">Calling application name</td></tr>
          <tr><td class="param-name">moveType</td><td class="param-type">string</td><td class="param-desc">Move type classification</td></tr>
        </table>
        <div class="code-block"><span class="tp">string</span> result = <span class="fn">ConnectedShop.ExecuteSingleMove</span>(
    <span class="str">"TXN-001"</span>,
    cboj.PK_BOM_OPERATIONS_JOB.ToString(),
    fromWhs.PK_WHS.ToString(),
    toWhs.PK_WHS.ToString(),
    <span class="num">5.0</span>,
    user.PK_USERS.ToString(),
    <span class="str">"MyApp"</span>,
    <span class="str">"Standard"</span>
);</div>
      </div>
    </div>

  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê OPERATIONS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="operations">
  <h2 class="section-title"><span class="section-icon">‚öôÔ∏è</span>Operations</h2>
  <div class="method-grid">
    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">OperationsUpdateCBOJBeforeMBLDelete</span><span class="method-desc">Update operation log before material line deletion</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">pkMBL</td><td class="param-type">string</td><td class="param-desc">Material BOM Line GUID being deleted</td></tr>
          <tr><td class="param-name">pkCBOJ</td><td class="param-type">string</td><td class="param-desc">CBOJ GUID to update</td></tr>
        </table>
        <div class="code-label">Unit Test Example</div>
        <div class="code-block"><span class="tp">Guid</span> pkCBOJ = <span class="tp">Guid</span>.<span class="fn">Parse</span>(<span class="str">"8BBF4B89-9869-483B-9EF8-0A6287628D2F"</span>);
<span class="tp">Guid</span> pkMBL  = <span class="tp">Guid</span>.<span class="fn">Parse</span>(<span class="str">"B8088D98-9B29-4412-89DE-523C3C7C36AD"</span>);

<span class="fn">ConnectedShop.OperationsUpdateCBOJBeforeMBLDelete</span>(
    pkMBL.ToString(),
    pkCBOJ.ToString()
);
<span class="cm">// Verify: all MRP_BOM_LOG rows with FK_BOM_OPERATION==pkCBOJ
//         have STATUSCODE == 2</span></div>
      </div>
    </div>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê WORK ORDERS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="wo">
  <h2 class="section-title"><span class="section-icon">üè≠</span>Work Orders (WO)</h2>
  <p>SigmaNEST Work Order management. Unit test stubs exist but are not yet implemented.</p>
  <div class="method-grid">

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-void">void</span><span class="method-name">WOAddPartToWorkOrder2</span><span class="method-desc">Add a part to a work order</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">aWONumber</td><td class="param-type">string</td><td class="param-desc">Work order number</td></tr>
          <tr><td class="param-name">aPartName</td><td class="param-type">string</td><td class="param-desc">Part name</td></tr>
          <tr><td class="param-name">aQuantity</td><td class="param-type">int</td><td class="param-desc">Quantity of parts</td></tr>
          <tr><td class="param-name">aMaterial</td><td class="param-type">string</td><td class="param-desc">Material specification</td></tr>
          <tr><td class="param-name">aThickness</td><td class="param-type">double</td><td class="param-desc">Part thickness</td></tr>
          <tr><td class="param-name">aPartFileName</td><td class="param-type">string</td><td class="param-desc">CAD file path</td></tr>
          <tr><td class="param-name">aCustomer</td><td class="param-type">string</td><td class="param-desc">Customer name</td></tr>
          <tr><td class="param-name">aWODate</td><td class="param-type">double</td><td class="param-desc">Due date (OLE Automation date)</td></tr>
          <tr><td class="param-name">aReleasedForManufacturing</td><td class="param-type">bool</td><td class="param-desc">Release immediately</td></tr>
          <tr><td class="param-name">addQty</td><td class="param-type">bool</td><td class="param-desc"><code>true</code> = add to existing qty ¬∑ <code>false</code> = replace</td></tr>
        </table>
        <div class="code-block"><span class="fn">ConnectedShop.WOAddPartToWorkOrder2</span>(
    <span class="str">"WO-001"</span>, <span class="str">"PartA"</span>, <span class="num">10</span>, <span class="str">"MS"</span>, <span class="num">3.0</span>,
    <span class="str">"A001"</span>,         <span class="cm">// revision</span>
    <span class="str">@"C:\Parts\PartA.dxf"</span>,
    <span class="str">"CustomerX"</span>,
    <span class="tp">DateTime</span>.Now.AddDays(<span class="num">30</span>).<span class="fn">ToOADate</span>(),
    <span class="str">""</span>,            <span class="cm">// drawing number</span>
    <span class="str">"ProgrammerA"</span>,
    <span class="str">""</span>,            <span class="cm">// remark</span>
    <span class="num">1</span>,             <span class="cm">// priority</span>
    <span class="num">0</span>,             <span class="cm">// machine number</span>
    <span class="num">0</span>,             <span class="cm">// onHold</span>
    <span class="str">""</span>,            <span class="cm">// partData</span>
    <span class="kw">true</span>,          <span class="cm">// releasedForManufacturing</span>
    <span class="str">"SalesRep"</span>,
    <span class="kw">false</span>          <span class="cm">// addQty</span>
);</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-void">void</span><span class="method-name">WOModifySNWO</span><span class="method-desc">Modify work order header</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">aWorkOrderNumber</td><td class="param-type">string</td><td class="param-desc">Work order number</td></tr>
          <tr><td class="param-name">aCustomer</td><td class="param-type">string</td><td class="param-desc">Customer name</td></tr>
          <tr><td class="param-name">aPriority</td><td class="param-type">int</td><td class="param-desc">Priority level (1 = highest)</td></tr>
          <tr><td class="param-name">aOnHold</td><td class="param-type">int</td><td class="param-desc">0 = active ¬∑ 1 = on hold</td></tr>
          <tr><td class="param-name">aWorkOrderDate</td><td class="param-type">double</td><td class="param-desc">Due date (OLE Automation date)</td></tr>
          <tr><td class="param-name">aSalesRep</td><td class="param-type">string</td><td class="param-desc">Sales representative name</td></tr>
          <tr><td class="param-name">aWoData1‚Äì4</td><td class="param-type">string</td><td class="param-desc">Custom data fields 1‚Äì4</td></tr>
        </table>
        <div class="code-block"><span class="fn">ConnectedShop.WOModifySNWO</span>(
    <span class="str">"WO-001"</span>, <span class="str">"CustomerX"</span>, <span class="num">1</span>, <span class="num">0</span>,
    <span class="tp">DateTime</span>.Now.AddDays(<span class="num">30</span>).<span class="fn">ToOADate</span>(),
    <span class="str">"SalesRep"</span>, <span class="str">""</span>, <span class="str">""</span>, <span class="str">""</span>, <span class="str">""</span>
);</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-void">void</span><span class="method-name">WOCancelSNWO</span><span class="method-desc">Cancel/delete a work order</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">aWONumber</td><td class="param-type">string</td><td class="param-desc">Work order number to cancel</td></tr>
        </table>
        <div class="info-box warn"><div class="label">Warning</div>Permanently deletes the work order. Ensure all parts are processed first.</div>
        <div class="code-block"><span class="fn">ConnectedShop.WOCancelSNWO</span>(<span class="str">"WO-001"</span>);</div>
      </div>
    </div>

    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-void">void</span><span class="method-name">WORemovePartFromWorkOrder</span><span class="method-desc">Remove a specific part from a WO</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">aWONumber</td><td class="param-type">string</td><td class="param-desc">Work order number</td></tr>
          <tr><td class="param-name">aPartName</td><td class="param-type">string</td><td class="param-desc">Part name to remove</td></tr>
        </table>
        <div class="code-block"><span class="fn">ConnectedShop.WORemovePartFromWorkOrder</span>(<span class="str">"WO-001"</span>, <span class="str">"PartA"</span>);</div>
      </div>
    </div>

  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê WAREHOUSE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="warehouse">
  <h2 class="section-title"><span class="section-icon">üè¨</span>Warehouse</h2>
  <div class="method-grid">
    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">WarehouseAutoCreateWHSFromWorkstation</span><span class="method-desc">Auto-create warehouse locations from workstations</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <p>No parameters. Automatically generates warehouse location records from all defined workstations.</p>
        <div class="code-block"><span class="tp">string</span> result = <span class="fn">ConnectedShop.WarehouseAutoCreateWHSFromWorkstation</span>();
<span class="cm">// Creates MRP_WHS records for each workstation that doesn't already have one</span></div>
      </div>
    </div>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê USER PERMISSIONS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="user-permission">
  <h2 class="section-title"><span class="section-icon">üîë</span>User Permissions</h2>
  <div class="method-grid">
    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-void">void</span><span class="method-name">UserPermissionAddUpdateUserSecurityRoles</span><span class="method-desc">Add or update user security roles</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">userSecurityRoleJson</td><td class="param-type">string (JSON)</td><td class="param-desc">UserSecurityRoleDb model as JSON</td></tr>
        </table>
        <div class="code-block"><span class="fn">ConnectedShop.UserPermissionAddUpdateUserSecurityRoles</span>(
    <span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(roleModel)
);</div>
      </div>
    </div>
    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-void">void</span><span class="method-name">UserPermissionDeleteUserAccess</span><span class="method-desc">Remove user security roles</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">userName</td><td class="param-type">string</td><td class="param-desc">Username to modify</td></tr>
          <tr><td class="param-name">roleIdJson</td><td class="param-type">string (JSON)</td><td class="param-desc">JSON array of role IDs to remove</td></tr>
        </table>
        <div class="code-block"><span class="fn">ConnectedShop.UserPermissionDeleteUserAccess</span>(
    <span class="str">"john.smith"</span>,
    <span class="tp">JsonConvert</span>.<span class="fn">SerializeObject</span>(<span class="kw">new</span> <span class="kw">int</span>[] { <span class="num">5</span>, <span class="num">12</span>, <span class="num">17</span> })
);</div>
      </div>
    </div>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê BIG DATA ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="big-data">
  <h2 class="section-title"><span class="section-icon">üíæ</span>Big Data</h2>
  <div class="method-grid">
    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-string">string</span><span class="method-name">ExecuteBigDataCommand</span><span class="method-desc">Run BigDataRunner.exe with arguments</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">command</td><td class="param-type">string</td><td class="param-desc">Command-line arguments for BigDataRunner.exe</td></tr>
        </table>
        <div class="code-block"><span class="tp">string</span> result = <span class="fn">ConnectedShop.ExecuteBigDataCommand</span>(
    <span class="str">"--export-jobs --date-from 2024-01-01"</span>
);</div>
      </div>
    </div>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PLUGINS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="plugins">
  <h2 class="section-title"><span class="section-icon">üîå</span>Plugins</h2>
  <p>Plugin lifecycle hooks ‚Äî 40+ event callbacks that fire before and after major operations. Returning <code>false</code> from a <strong>Before</strong> hook cancels the operation.</p>
  <div class="method-grid">
    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">PluginsInitPluginManager</span><span class="method-desc">Initialize the plugin system</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">pluginPath</td><td class="param-type">string</td><td class="param-desc">Directory containing plugin DLLs</td></tr>
        </table>
        <div class="code-block"><span class="fn">ConnectedShop.PluginsInitPluginManager</span>(<span class="str">@"C:\SigmaMRP\Plugins\"</span>);</div>
      </div>
    </div>
  </div>

  <h3 class="sub-title">Available Hook Pairs (Before / After)</h3>
  <table class="error-table">
    <tr><th>Event Pair (Plugins prefix omitted)</th><th>Key Parameters</th><th>Fires when‚Ä¶</th></tr>
    <tr><td class="code-val">OnBefore/AfterAddCompany</td><td>CompanyName / pkCompany</td><td>Company is created</td></tr>
    <tr><td class="code-val">OnBefore/AfterAddContact</td><td>pkCompany+contactName / pkContact</td><td>Contact is created</td></tr>
    <tr><td class="code-val">OnBefore/AfterJobStatusChange</td><td>pkJob, jobStatus</td><td>Job status changes</td></tr>
    <tr><td class="code-val">OnAfterJobCreation</td><td>pkJob</td><td>Job is created</td></tr>
    <tr><td class="code-val">OnAfterPOCreation</td><td>pkJob</td><td>PO is created</td></tr>
    <tr><td class="code-val">OnBefore/AfterSaveInvoice</td><td>pkDocumentHeader</td><td>Invoice is saved</td></tr>
    <tr><td class="code-val">OnBefore/AfterSavePOInvoice</td><td>pkDocumentHeader</td><td>PO invoice is saved</td></tr>
    <tr><td class="code-val">OnBefore/AfterBookInfromJob</td><td>pkJobItem / pkJobItem+batchName</td><td>Book-in from job</td></tr>
    <tr><td class="code-val">OnBefore/AfterCOUpdateProgram</td><td>programName, repeatId</td><td>Single CO program update</td></tr>
    <tr><td class="code-val">OnBefore/AfterStartRecording</td><td>programName, repeatId</td><td>Recording starts</td></tr>
    <tr><td class="code-val">OnBefore/AfterFinishRecording</td><td>programName, repeatId</td><td>Recording finishes</td></tr>
    <tr><td class="code-val">OnBefore/AfterResetRecording</td><td>programName, repeatId</td><td>Recording is reset</td></tr>
    <tr><td class="code-val">OnBefore/AfterSwapSheet</td><td>programName, repeatId</td><td>Sheet is swapped</td></tr>
    <tr><td class="code-val">OnBefore/AfterRejectParts</td><td>programName, repeatId</td><td>Parts are rejected</td></tr>
  </table>

  <div class="code-label" style="margin-top:1rem">Execute Custom Plugin Method</div>
  <div class="code-block"><span class="tp">bool</span> ok = <span class="fn">ConnectedShop.PluginsExecutePluginMethod</span>(
    <span class="str">"MyCustomAction"</span>,
    entityGuid.ToString()
);</div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê UI ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="ui">
  <h2 class="section-title"><span class="section-icon">üñ•Ô∏è</span>UI</h2>
  <div class="method-grid">
    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-bool">bool</span><span class="method-name">UIOpenFeedbackAndSuggestionPortal</span><span class="method-desc">Open feedback web portal</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">AppName</td><td class="param-type">string</td><td class="param-desc">Calling application name</td></tr>
        </table>
        <div class="code-block"><span class="fn">ConnectedShop.UIOpenFeedbackAndSuggestionPortal</span>(<span class="str">"SigmaMRP"</span>);</div>
      </div>
    </div>
    <div class="method-card">
      <div class="method-header" onclick="toggle(this)"><span class="ret-badge ret-void">void</span><span class="method-name">UIOpenHelpFile</span><span class="method-desc">Open application help file</span><span class="expand-icon">‚ñº</span></div>
      <div class="method-body">
        <table class="param-table"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
          <tr><td class="param-name">applicationName</td><td class="param-type">string</td><td class="param-desc">Application name to open help for</td></tr>
        </table>
        <div class="code-block"><span class="fn">ConnectedShop.UIOpenHelpFile</span>(<span class="str">"SigmaMRP"</span>);</div>
      </div>
    </div>
  </div>
</section>

</main>

<script>
function toggle(header) { header.parentElement.classList.toggle('open'); }
function filterNav(query) {
  const q = query.toLowerCase();
  document.querySelectorAll('.nav-link').forEach(l => {
    l.style.display = l.textContent.toLowerCase().includes(q) ? '' : 'none';
  });
}
const sections = document.querySelectorAll('section[id]');
const navLinks  = document.querySelectorAll('.nav-link');
function setActive() {
  let current = '';
  sections.forEach(s => { if (window.scrollY + 90 >= s.offsetTop) current = s.id; });
  navLinks.forEach(l => { l.classList.toggle('active', l.getAttribute('href') === '#' + current); });
}
window.addEventListener('scroll', setActive, { passive: true });
setActive();
</script>
</body>
</html>
